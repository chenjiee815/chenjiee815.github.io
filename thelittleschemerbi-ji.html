<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Chen Jie" />
        <meta name="copyright" content="Chen Jie" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="lisp, scheme, guile, scheme, " />

<meta property="og:title" content="TheLittleSchemer笔记 "/>
<meta property="og:url" content="/thelittleschemerbi-ji.html" />
<meta property="og:description" content="Contents 总纲 scheme十戒 scheme五律 第一章: Toys 基本概念 其它概念 第二章: Do It, Do It Again, and Again, and Again… lat操作 基本概念 应用 第三章: Cons the Magnificent lat操作 应用 第四章: Numbers Games 数字操作 基本概念 应用 综合操作 第五章: *Oh My Gawd*: It&#39;s Full of Stars 第六章: Shadows 应用 第七章: Friends and Relations ..." />
<meta property="og:site_name" content="January Star" />
<meta property="og:article:author" content="Chen Jie" />
<meta property="og:article:published_time" content="2014-06-22T00:00:00" />
<meta name="twitter:title" content="TheLittleSchemer笔记 ">
<meta name="twitter:description" content="Contents 总纲 scheme十戒 scheme五律 第一章: Toys 基本概念 其它概念 第二章: Do It, Do It Again, and Again, and Again… lat操作 基本概念 应用 第三章: Cons the Magnificent lat操作 应用 第四章: Numbers Games 数字操作 基本概念 应用 综合操作 第五章: *Oh My Gawd*: It&#39;s Full of Stars 第六章: Shadows 应用 第七章: Friends and Relations ...">

        <title>TheLittleSchemer笔记  · January Star
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-52167018-1', 'auto');
    ga('send', 'pageview');
</script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <div class="span1"></div>
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="/"><span class=site-name>January Star</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="">Home</a></li>
                            <li ><a href="/categories.html">Categories</a></li>
                            <li ><a href="/tags.html">Tags</a></li>
                            <li ><a href="/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="/thelittleschemerbi-ji.html"> TheLittleSchemer笔记  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id23">总纲</a><ul>
<li><a class="reference internal" href="#scheme" id="id24">scheme十戒</a></li>
<li><a class="reference internal" href="#id2" id="id25">scheme五律</a></li>
</ul>
</li>
<li><a class="reference internal" href="#toys" id="id26">第一章: Toys</a><ul>
<li><a class="reference internal" href="#id3" id="id27">基本概念</a></li>
<li><a class="reference internal" href="#id4" id="id28">其它概念</a></li>
</ul>
</li>
<li><a class="reference internal" href="#do-it-do-it-again-and-again-and-again" id="id29">第二章: Do It, Do It Again, and Again, and Again…</a><ul>
<li><a class="reference internal" href="#lat" id="id30">lat操作</a><ul>
<li><a class="reference internal" href="#id5" id="id31">基本概念</a></li>
<li><a class="reference internal" href="#id6" id="id32">应用</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#cons-the-magnificent" id="id33">第三章: Cons the Magnificent</a><ul>
<li><a class="reference internal" href="#id7" id="id34">lat操作</a><ul>
<li><a class="reference internal" href="#id8" id="id35">应用</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#numbers-games" id="id36">第四章: Numbers Games</a><ul>
<li><a class="reference internal" href="#id9" id="id37">数字操作</a><ul>
<li><a class="reference internal" href="#id10" id="id38">基本概念</a></li>
<li><a class="reference internal" href="#id11" id="id39">应用</a></li>
<li><a class="reference internal" href="#id12" id="id40">综合操作</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#oh-my-gawd-it-s-full-of-stars" id="id41">第五章: *Oh My Gawd*: It's Full of Stars</a></li>
<li><a class="reference internal" href="#shadows" id="id42">第六章: Shadows</a><ul>
<li><a class="reference internal" href="#id13" id="id43">应用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#friends-and-relations" id="id44">第七章: Friends and Relations</a><ul>
<li><a class="reference internal" href="#set" id="id45">set操作</a><ul>
<li><a class="reference internal" href="#id14" id="id46">基本概念</a></li>
<li><a class="reference internal" href="#id15" id="id47">应用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pair" id="id48">pair操作</a><ul>
<li><a class="reference internal" href="#id16" id="id49">基本概念</a></li>
<li><a class="reference internal" href="#id17" id="id50">应用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rel" id="id51">rel操作</a><ul>
<li><a class="reference internal" href="#id18" id="id52">基本概念</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fun" id="id53">fun操作</a><ul>
<li><a class="reference internal" href="#id19" id="id54">基本概念</a></li>
<li><a class="reference internal" href="#id20" id="id55">应用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fullfun" id="id56">fullfun操作</a><ul>
<li><a class="reference internal" href="#id21" id="id57">基本概念</a></li>
<li><a class="reference internal" href="#id22" id="id58">应用</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#lambda-the-ultimate" id="id59">第八章: Lambda the Ultimate</a></li>
<li><a class="reference internal" href="#and-again-and-again-and-again" id="id60">第九章: … and Again, and Again, and Again, …</a></li>
<li><a class="reference internal" href="#what-is-the-value-of-all-of-this" id="id61">第十章: What Is the Value of All of This?</a></li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id23">总纲</a></h2>
<div class="section" id="scheme">
<h3><a class="toc-backref" href="#id24">scheme十戒</a></h3>
<ol class="arabic">
<li><p class="first">当对一个原子列表进行递归时，要注意两个问题：(null? lat) and else。</p>
<p>当对一个数字进行递归时，要注意两个问题：(zero? n) and else。</p>
<p>当对一个S表达式列表进行递归时，要注意三个问题：(null? l), (atom? (car l)) 和 else。</p>
</li>
<li><p class="first">使用cons来创建列表。</p>
</li>
<li><p class="first">当创建一个列表时，先描述第一个元素，然后用cons来将它和递归连接在一起</p>
</li>
<li><p class="first">递归时，至少要改变一个参数。 例如：递归一个原子列表使用(cdr lat)；递归一个数字使用(sub1 n)；</p>
<p>递归一个S表达式时，如果这个表达式即不(null? l)，也不(atom? (car l))， 那么使用(car l) 和 (cdr l)。</p>
<p>并且该参数必须要越来越接近终止元素。在终止条件里面必须要对正在变化的参数进行检查：</p>
<blockquote>
<ul class="simple">
<li>当使用cdr时，终止条件使用null?</li>
<li>当使用sub1时，终止条件使用zero?</li>
</ul>
</blockquote>
</li>
<li><p class="first">当你使用+来创建一个值时，必须总要用0来作为终止，0加上任何值都不会改变原来的值。</p>
<p>当你使用*来创建一个值时，必须总要用1来作为终止，1乘以任务值都不会改变原来的值。</p>
<p>当你使用cons来创建一个值时，必须总要用()来作为终止。</p>
</li>
<li><p class="first">当函数运行正确后再考虑简化函数。</p>
</li>
<li><p class="first">当一个对象的子对象是与其本身表现一致时，这时候可用递归操作。比如：</p>
<blockquote>
<ul class="simple">
<li>一个列表的子列表</li>
<li>一个算术表达式的子表达式</li>
</ul>
</blockquote>
</li>
<li><p class="first">使用help函数来简化表述。</p>
</li>
<li><p class="first">使用新的函数来抽象公共模式。</p>
</li>
<li><p class="first">创建函数时，尽量能够一次性获取更多的值。</p>
</li>
</ol>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id25">scheme五律</a></h3>
<ol class="arabic simple">
<li>car函数最初只是用在非空列表上的。</li>
<li>cdr函数最初只是用在非空列表上的，(cdr non-null-list)的结果是另一个列表。</li>
<li>cons函数最初只接受两个参数，第二个参数必须是一个列表，它返回的结果也是一个列表。</li>
<li>null?函数只对列表有用。</li>
<li>eq?函数只接受两个参数，两个参数必须都是非数字的原子。</li>
</ol>
</div>
</div>
<div class="section" id="toys">
<h2><a class="toc-backref" href="#id26">第一章: Toys</a></h2>
<p>作者目的：使读者了解scheme一些基本概念和一些常用函数，为接下来的章节打基础。</p>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id27">基本概念</a></h3>
<ul>
<li><p class="first">S表达式: scheme中所以元素都可以叫做S表达式。</p>
</li>
<li><p class="first">atom: 原子，是指一个非列表的S表达式。</p>
</li>
<li><p class="first">list: 列表，用()包围起来的S表达式。</p>
</li>
<li><p class="first">car: 返回非空列表中的首个S表达式， 所以它操作的对象一定要是非空的列表(十戒第一条)。</p>
</li>
<li><p class="first">cdr: 取出非空列表中的除首个S表达式的列表， 它操作的对象也是要非空列表(十戒第一条)。</p>
</li>
<li><p class="first">cons: 将两个S表达式连接成一个列表，第二个必须是一个列表。</p>
</li>
<li><p class="first">null?: 只判断列表是否为空(scheme五律第四条)。</p>
</li>
<li><p class="first">atom?: 用来判断一个S表达式是否为一个原子。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
     <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">m</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">m</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">eq?: 用来判断两个非数字的的原子是否相等，
(PS: guile的实现不太一样，它还可以比较数字。)</p>
</li>
</ul>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id28">其它概念</a></h3>
<ul class="simple">
<li>define: 用来定义一个名称，或者一个函数。</li>
<li>lambda: 用来定义一个函数。</li>
<li>cond: 相当于其它语言中的switch。</li>
<li>else: 永远返回#t, 即True。</li>
</ul>
</div>
</div>
<div class="section" id="do-it-do-it-again-and-again-and-again">
<h2><a class="toc-backref" href="#id29">第二章: Do It, Do It Again, and Again, and Again…</a></h2>
<div class="section" id="lat">
<h3><a class="toc-backref" href="#id30">lat操作</a></h3>
<div class="section" id="id5">
<h4><a class="toc-backref" href="#id31">基本概念</a></h4>
<ul class="simple">
<li>lat: 列表中包含的每个S表达式都是原子的列表。</li>
</ul>
</div>
<div class="section" id="id6">
<h4><a class="toc-backref" href="#id32">应用</a></h4>
<ul>
<li><p class="first">lat?: 判断列表中是否每个S表达式都是原子。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">lat?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">lat?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span> <span class="nv">nolat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">null? </span><span class="nv">nolat</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">lat?&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">()))</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">lat?&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
                                <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span> <span class="nv">nolat</span><span class="p">)</span>
                                  <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">nolat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">lat?&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
                     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span> <span class="nv">nolat</span><span class="p">)</span>
                       <span class="p">(</span><span class="nf">col</span> <span class="nv">lat</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">nolat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">member?: 用来判断一个S表达式是否在一个列表之内。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">member?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>

<span class="c1">; CPS变换</span>
<span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">in</span> <span class="nv">out</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">in</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">member?&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">member?&amp;co</span> <span class="nv">a</span>
                                     <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                                     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">in</span> <span class="nv">out</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">a</span> <span class="nv">in</span><span class="p">)</span> <span class="nv">out</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">member?&amp;co</span> <span class="nv">a</span>
                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">in</span> <span class="nv">out</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">col</span> <span class="nv">in</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">a</span> <span class="nv">out</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
</div>
<div class="section" id="cons-the-magnificent">
<h2><a class="toc-backref" href="#id33">第三章: Cons the Magnificent</a></h2>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id34">lat操作</a></h3>
<div class="section" id="id8">
<h4><a class="toc-backref" href="#id35">应用</a></h4>
<ul>
<li><p class="first">rember: 将一个S表达式从一个列表中删除。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">rember</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rmcount</span> <span class="nv">leftlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">rmcount</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">leftlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">leftlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">rember&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">()))</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">rember&amp;co</span> <span class="nv">a</span>
                       <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rmcount</span> <span class="nv">leftlat</span><span class="p">)</span>
                         <span class="p">(</span><span class="nf">col</span> <span class="nv">rmcount</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">leftlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">firsts: 从一个列表中的获取其每个子列表的首个S表达式，并以列表形式返回</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">firsts</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">firsts</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">first_ed</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">first_ed</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">first_ed</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">firsts&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">col</span><span class="p">)</span> <span class="p">(</span><span class="nb">display </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
    <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">firsts&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
                     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">first_ed</span><span class="p">)</span>
                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="nv">first_ed</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">insertR: 将一个S表达式插入到一个列表中指定S表达式的右边，
并返回修改后的列表 insertL: 基本同上，只不过是插入到左边</p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">insert*函数的整体逻辑与rember是差不多的。</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insertR</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">insertR&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">insertR&amp;co</span> <span class="nv">new</span>
                        <span class="nv">old</span>
                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span> <span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insertL</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">insertL&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">insertL&amp;co</span> <span class="nv">new</span>
                        <span class="nv">old</span>
                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">subst: 用新的S表达式替代列表中指定的S表达式，
并返回修改后的列表 subst2:
用来替代列表中指定的两个S表达式</p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">subst*函数的整体逻辑也与rember是差不多的。</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">subst</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">subst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">subst&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">subst&amp;co</span> <span class="nv">new</span>
                      <span class="nv">old</span>
                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">subst2</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old1</span> <span class="nv">old2</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old1</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">old2</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">subst2</span> <span class="nv">new</span> <span class="nv">old1</span> <span class="nv">old2</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>

<span class="c1">;subst2简化版本</span>
<span class="p">(</span><span class="k">define </span><span class="nv">subst2</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old1</span> <span class="nv">old2</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">old2</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">eq? </span><span class="nv">old1</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)))</span>
       <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                  <span class="p">(</span><span class="nf">subst2</span> <span class="nv">new</span> <span class="nv">old1</span> <span class="nv">old2</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">subst2&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old1</span> <span class="nv">old2</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">old1</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">eq? </span><span class="nv">old2</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)))</span>
       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">subst&amp;co</span> <span class="nv">new</span>
                      <span class="nv">old1</span>
                      <span class="nv">old2</span>
                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multirember: 基本同rember, 只不过是列表中所有符合的S表达式都会删除.</p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">其逻辑基本是在rember逻辑上进行扩充的。</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multirember</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre> <span class="p">(</span><span class="k">define </span><span class="nv">col</span>
   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rmcount</span> <span class="nv">newlat</span><span class="p">)</span>
     <span class="p">(</span><span class="nb">display </span><span class="nv">rmcount</span><span class="p">)</span>
     <span class="p">(</span><span class="nb">display </span><span class="s">&quot; &quot;</span><span class="p">)</span>
     <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
     <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">multirember&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">multirember&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rmcount</span> <span class="nv">newlat</span><span class="p">)</span>
                                    <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">rmcount</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">multirember&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rmcount</span> <span class="nv">newlat</span><span class="p">)</span>
                                    <span class="p">(</span><span class="nf">col</span> <span class="nv">rmcount</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multiinsertR: 基本同insertR,
只不过是列表中所有符合的s表达式都会插入其右边。
注意：其逻辑基本是在insertR逻辑上进行扩充的。</p>
</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertR</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nf">multiinsertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multiinsertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">inscount</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="s">&quot; &quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">multiinsertR&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">multiinsertR&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
                                             <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">inscount</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">newlat</span><span class="p">))))))</span>
     <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">multiinsertR&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
                                             <span class="p">(</span><span class="nf">col</span> <span class="nv">inscount</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table><ul>
<li><p class="first">multiinsertL: 基本同insertL, 只不过是列表中所有符合的s表达式都会插入其左边.
注意：其逻辑基本是在insertL逻辑上进行扩充的。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertL</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nf">multiinsertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multiinsertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">inscount</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="s">&quot; &quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mutlinsertL&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">mutlinsertL&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
                                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">inscount</span> <span class="mi">1</span><span class="p">)</span>
                                               <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="nv">newlat</span><span class="p">))))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">mutlinsertL&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
                                          <span class="p">(</span><span class="nf">col</span> <span class="nv">inscount</span>
                                               <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multisubst: 基本同sbust, 只不过是列表中所有符合的s表达式都替换</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multisubst</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nf">multisubst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multisubst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">stcount</span> <span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">stcount</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="s">&quot; &quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newlat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newlat</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mutlsubst&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">mutlisubst&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
                                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">inscount</span> <span class="mi">1</span><span class="p">)</span>
                                               <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">newlat</span><span class="p">)))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">mutlisubst&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">inscount</span> <span class="nv">newlat</span><span class="p">)</span>
                                          <span class="p">(</span><span class="nf">col</span> <span class="nv">inscount</span>
                                               <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
</div>
<div class="section" id="numbers-games">
<h2><a class="toc-backref" href="#id36">第四章: Numbers Games</a></h2>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id37">数字操作</a></h3>
<div class="section" id="id10">
<h4><a class="toc-backref" href="#id38">基本概念</a></h4>
<ul class="simple">
<li>数字也是一个atom</li>
<li>number?: 判断一个S表达式是否为数字</li>
<li>tup: 列表中包含的每个s表达式都是数字的列表。</li>
</ul>
</div>
<div class="section" id="id11">
<h4><a class="toc-backref" href="#id39">应用</a></h4>
<ul>
<li><p class="first">add1: 对数字加1</p>
</li>
<li><p class="first">sub1: 对数字减1</p>
</li>
<li><p class="first">+: 将两个数字相加</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">+</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">b</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">myadd&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
    <span class="p">((</span><span class="nb">zero? </span><span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="nv">a</span><span class="p">))</span>
    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">myadd&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">- </span><span class="nv">b</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                                <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">num</span> <span class="mi">1</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">-: 将两个数字相减</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">-</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">sub1</span> <span class="p">(</span><span class="nb">- </span><span class="nv">a</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">b</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mysub&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="nv">a</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">mysub&amp;co</span> <span class="p">(</span><span class="nb">- </span><span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">b</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">col</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">addtup: 一个tup中的所有数字相加</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">addtup</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="nf">addtup</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">addtup&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">addtup&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sum</span><span class="p">)</span>
                             <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">sum</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">*: 将两个数字相乘</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mymulti&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">mymulti&amp;co</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                                   <span class="p">(</span><span class="nb">+ </span><span class="nv">num</span> <span class="nv">n</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">tup+: 将两个tup中相对的数字相加,然后返回相加后的tup</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">; 该函数允许两个参数的长度不一样</span>
<span class="p">(</span><span class="k">define </span><span class="nv">tup+</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">)</span> <span class="nv">tup1</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="nv">tup2</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">+_</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup2</span><span class="p">))</span>
                     <span class="p">(</span><span class="nf">tup+</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup2</span><span class="p">)))))))</span>

<span class="c1">; 该函数的两个参数长度必须一样</span>
<span class="p">(</span><span class="k">define </span><span class="nv">tup+</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">+_</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup2</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">tup+</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup2</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newtup</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">newtup</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">newtup</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">tup+&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="nv">tup2</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="nv">tup1</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">tup+&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup2</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newtup</span><span class="p">)</span>
                                            <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup2</span><span class="p">))</span> <span class="nv">newtup</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">&lt;: 比较两个数字的大小 &gt;: 比较两个数字的大小</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">&gt;</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mylt&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="no">#f</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="no">#t</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">mylt&amp;co</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">col</span><span class="p">)))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">&lt;</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>
<span class="c1">;基本同上</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">=: 比较两个数字是否相等</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">=</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">=</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">&gt; </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="no">#t</span><span class="p">))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">^: 阶乘</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">^</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="p">(</span><span class="nf">^</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mypower&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">1</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">mypower&amp;co</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                                   <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="nv">num</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">/: 除</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">/</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">m</span><span class="p">))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">mydiv&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">mydiv&amp;co</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">m</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">num</span> <span class="mi">1</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
<div class="section" id="id12">
<h4><a class="toc-backref" href="#id40">综合操作</a></h4>
<ul>
<li><p class="first">length: 返回一个lat的长度</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">length</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">length&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">length&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                                  <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">num</span> <span class="mi">1</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">pick: 根据传入的数字,获取其对应在lat中位置的S表达式</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">pick</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">pick&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">pick&amp;co</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">col</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">rempick: 根据传入的数字, 删除其对应在lat中位置的S表达式,并返回剩余列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">rempick</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">rempick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">rempick&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">rempick&amp;co</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
                                           <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">no-nums: 选出列表中的非数字S表达式, 并以列表形式返回</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">no-nums</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">number? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">no-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">no-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">nonum&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">number? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">nonum&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">col</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">nonum&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">all-nums: 跟上面相反, 只返回数字列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">all-nums</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">not </span><span class="p">(</span><span class="nb">number? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)))</span> <span class="p">(</span><span class="nf">all-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">all-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>

<span class="c1">;逻辑基本同上</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">eqan?: 比较两个S表达式是否是相等</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">eqan?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a1</span> <span class="nv">a2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">number? </span><span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">a2</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">= </span><span class="nv">a1</span> <span class="nv">a2</span><span class="p">))</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">number? </span><span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">a2</span><span class="p">))</span>
      <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">a1</span> <span class="nv">a2</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">occur?: 检查列表中有几个指定的S表达式</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">occur</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">eqan?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">occur</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">occur</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">occur&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">n</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">occur&amp;co</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                              <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">num</span> <span class="mi">1</span><span class="p">)))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">occur&amp;co</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">col</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">one?: 判断一个数字是否为1</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">one?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">one?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">=_</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
</div>
<div class="section" id="oh-my-gawd-it-s-full-of-stars">
<h2><a class="toc-backref" href="#id41">第五章: *Oh My Gawd*: It's Full of Stars</a></h2>
<ul>
<li><p class="first">rember*: 基本同rember, 但其处理的对象包括一个嵌套的列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">rember*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">rember*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">rember*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">col</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">rember*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">newl</span><span class="p">)))))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">rember*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">carl</span><span class="p">)</span>
                              <span class="p">(</span><span class="nf">rember*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">cdrl</span><span class="p">)</span>
                                                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">carl</span> <span class="nv">cdrl</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">insertR*: 基本同insertR, 但其处理的对象包括一个嵌套的列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insertR*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">insertR*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">insertR*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">newl</span><span class="p">))))))</span>
       <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">insertR*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">newl</span><span class="p">)))))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">insertR*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">carl</span><span class="p">)</span>
                                     <span class="p">(</span><span class="nf">insertR*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">cdrl</span><span class="p">)</span>
                                                                    <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">carl</span> <span class="nv">cdrl</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">occur*: 基本同occur, 但其处理的对象包括一个嵌套的列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">occur*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">+_</span> <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
                <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">occur*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">occur*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
                               <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">num</span> <span class="mi">1</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">occur*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">col</span><span class="p">))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">occur*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">carnum</span><span class="p">)</span>
                             <span class="p">(</span><span class="nf">occur*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">cdrnum</span><span class="p">)</span>
                                                    <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">carnum</span> <span class="nv">cdrnum</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">subst*: 基本同subst, 但其处理的对象包括一个嵌套的列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">subst*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nf">subst*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">subst*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">subst*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">subst*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">subst*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="nv">l</span><span class="p">))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">subst*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                     <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">newl</span><span class="p">)))))</span>
       <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">subst*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                     <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">newl</span><span class="p">)))))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">subst*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">carl</span><span class="p">)</span>
                                   <span class="p">(</span><span class="nf">subst*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">cdrl</span><span class="p">)</span>
                                                                <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">carl</span> <span class="nv">cdrl</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">insertL*: 基本同insertL, 但其处理的对象包括一个嵌套的列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insertL*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
                 <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">insertL*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="nv">l</span><span class="p">))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">insertL*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="nv">newl</span><span class="p">))))))</span>
       <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">insertL*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="nv">newl</span><span class="p">)))))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">insertL*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">carl</span><span class="p">)</span>
                                     <span class="p">(</span><span class="nf">insertL*&amp;co</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">cdrl</span><span class="p">)</span>
                                                                    <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">carl</span> <span class="nv">cdrl</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">member*: 基本同member, 但其处理的对象包括一个嵌套的列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">member*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
               <span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">col</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">display </span><span class="nv">num</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">newline</span><span class="p">)</span>
    <span class="nv">num</span><span class="p">))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">member*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="no">#f</span><span class="p">))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
        <span class="p">(</span><span class="nf">col</span> <span class="no">#t</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">member*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">col</span><span class="p">))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">member*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">incar</span><span class="p">)</span>
                              <span class="p">(</span><span class="nf">member*&amp;co</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">incdr</span><span class="p">)</span>
                                                      <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="k">or </span><span class="nv">incar</span> <span class="nv">incdr</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">leftmost: 找出不包含空列表的列表/嵌套列表中的最左边的一个atom</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">leftmost</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">leftmost</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">eqlist?: 判断两个列表/嵌套列表是否相同</p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">作者通过equal?来简化了eqlist?，
而且equal?也是通过eqlist?来实现的。
只当函数正确的前提下再进行简化/优化。</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">eqlist?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqan?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">))))</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">)))))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">eqlist?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqan?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">))))</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
                <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">equal?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">eqan?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">eqlist?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">eqlist?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">rember: 重写之前简单的rember, 参数s代表任何S表达式,参数l代码任何列表</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">rember</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">equal? </span><span class="nv">s</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember</span> <span class="nv">s</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
<div class="section" id="shadows">
<h2><a class="toc-backref" href="#id42">第六章: Shadows</a></h2>
<p>这一章讲的是有关算术表达式的相关内容,
它通过帮助函数来 支持前缀中缀后缀算术表达式.
但我这里只写了前缀表达式的代码.</p>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id43">应用</a></h3>
<ul>
<li><p class="first">判断一个S表达式是否为算术表达式</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">numbered?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">aexp</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">aexp</span><span class="p">))</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="ss">&#39;+</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="ss">&#39;*</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="ss">&#39;^</span><span class="p">))</span>
      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">numberd?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">numberd?</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))))</span>
     <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">^: 倍数</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">^</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">expt </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">value: 获取一个算术表达式的值</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">)</span> <span class="ss">&#39;+</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">)))))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">)</span> <span class="ss">&#39;*</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">)))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">^</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))))))))</span>

<span class="c1">; 帮助函数</span>
<span class="p">(</span><span class="k">define </span><span class="mi">1</span><span class="nv">st-sub-exp</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))</span>

<span class="c1">; 帮助函数</span>
<span class="p">(</span><span class="k">define </span><span class="mi">2</span><span class="nv">nd-sub-exp</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">)))))</span>

<span class="c1">; 帮助函数</span>
<span class="p">(</span><span class="k">define </span><span class="nv">operator</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">)))</span>

<span class="c1">; 使用帮助函数重写的value函数</span>
<span class="c1">; 这样修改后的函数, 其实即可以用在前缀,也可以用在后缀表达式上</span>
<span class="c1">; 只要修改几个帮助函数即可</span>
<span class="p">(</span><span class="k">define </span><span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">&#39;+</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">)</span> <span class="ss">&#39;*</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
         <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span><span class="p">))))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">^</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">接下来作者用()来表示0, (())表示1, (() ())表示2…
然后定义了对应的原语函数: sero?, edd1, zub1,</p>
</li>
</ul>
</div>
</div>
<div class="section" id="friends-and-relations">
<h2><a class="toc-backref" href="#id44">第七章: Friends and Relations</a></h2>
<div class="section" id="set">
<h3><a class="toc-backref" href="#id45">set操作</a></h3>
<div class="section" id="id14">
<h4><a class="toc-backref" href="#id46">基本概念</a></h4>
<ul class="simple">
<li>set: 集合, 类似于列表, 但是它其中的元素唯一</li>
</ul>
</div>
<div class="section" id="id15">
<h4><a class="toc-backref" href="#id47">应用</a></h4>
<ul>
<li><p class="first">set?: 判断一个S表达式是否为set</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">set?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">makeset: 生成一个set</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">makeset</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">makeset</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">makeset</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>

<span class="c1">;使用multirember, 另外一种思路</span>
<span class="p">(</span><span class="k">define </span><span class="nv">makeset</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">makeset</span> <span class="p">(</span><span class="nf">multirember</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">subset?: 判断set1是否是set2的子集</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">subset?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">subset?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">subset?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">subset?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">eqset?: 判断两个set是否相等</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">eqset?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">subset?</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">subset?</span> <span class="nv">set2</span> <span class="nv">set1</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">interset?: 判断set1是否至少有一个S表达式在set2中</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">intersect?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">intersect?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">intersect?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">intersect?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">interset: 求两个set的交集</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">intersect</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span>
          <span class="p">(</span><span class="nb">null? </span><span class="nv">set2</span><span class="p">))</span>
      <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">union: 求两个set的并集</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">union</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">set2</span><span class="p">)</span> <span class="nv">set1</span><span class="p">)</span>
     <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">union</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">union</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">intersectall: 获取set中每个子set的交集</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">intersectall</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l-set</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l-set</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l-set</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l-set</span><span class="p">)</span>
                      <span class="p">(</span><span class="nf">intersectall</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l-set</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
<div class="section" id="pair">
<h3><a class="toc-backref" href="#id48">pair操作</a></h3>
<div class="section" id="id16">
<h4><a class="toc-backref" href="#id49">基本概念</a></h4>
<ul class="simple">
<li>pair: 点对, 只包含两个S表达式的列表</li>
</ul>
</div>
<div class="section" id="id17">
<h4><a class="toc-backref" href="#id50">应用</a></h4>
<ul>
<li><p class="first">a-pair?: 判断一个S表达式是否为pair</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">a-pair?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span> <span class="no">#t</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">first: 获取pair的第一个S表达式</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">first</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">)))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">second: 获取pair的第二个S表达式</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">second</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">build: 生成一个pair</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">build</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons </span><span class="nv">s1</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">s2</span> <span class="o">&#39;</span><span class="p">()))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
<div class="section" id="rel">
<h3><a class="toc-backref" href="#id51">rel操作</a></h3>
<div class="section" id="id18">
<h4><a class="toc-backref" href="#id52">基本概念</a></h4>
<ul class="simple">
<li>rel: 是一个内部嵌套pair的list, 但是其所有子pair是唯一的</li>
</ul>
</div>
</div>
<div class="section" id="fun">
<h3><a class="toc-backref" href="#id53">fun操作</a></h3>
<div class="section" id="id19">
<h4><a class="toc-backref" href="#id54">基本概念</a></h4>
<ul class="simple">
<li>fun: 同rel, 但其所有子pair的第一个元素也是唯一的, 类似于字典(key-&gt;value)</li>
</ul>
</div>
<div class="section" id="id20">
<h4><a class="toc-backref" href="#id55">应用</a></h4>
<ul>
<li><p class="first">fun?: 判断一个S表达式是否为fun</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">fun?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nf">firsts</span> <span class="nv">rel</span><span class="p">))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">revrel: 将fun中所有子pair的两个元素对调</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">revrel</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
    <span class="p">((</span><span class="nb">null? </span><span class="nv">rel</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">))</span>
                       <span class="p">(</span><span class="nf">first</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">)))</span>
                <span class="p">(</span><span class="nf">revrel</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rel</span><span class="p">))))))</span>

<span class="c1">; 如果将其中的pair中两元素对调写成一个单独的函数</span>
<span class="c1">; 则revrel看起来会更简洁明了</span>
<span class="p">(</span><span class="k">define </span><span class="nv">revpair</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pair</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pair</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">revrel</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
    <span class="p">((</span><span class="nb">null? </span><span class="nv">rel</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">revpair</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">))</span>
                <span class="p">(</span><span class="nf">revrel</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rel</span><span class="p">))))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
<div class="section" id="fullfun">
<h3><a class="toc-backref" href="#id56">fullfun操作</a></h3>
<div class="section" id="id21">
<h4><a class="toc-backref" href="#id57">基本概念</a></h4>
<ul class="simple">
<li>fullfun: 基本同fun, 但其所有子pair的第二个元素也是唯一的</li>
</ul>
</div>
<div class="section" id="id22">
<h4><a class="toc-backref" href="#id58">应用</a></h4>
<ul>
<li><p class="first">fullfun?: 判断一个S表达式是否为fullfun</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">fullfun?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">fun</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nf">seconds</span> <span class="nv">fun</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">fullfun?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">fun</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">fun?</span> <span class="p">(</span><span class="nf">revrel</span> <span class="nv">fun</span><span class="p">))))</span>
</pre></div>
</td></tr></table></li>
</ul>
</div>
</div>
</div>
<div class="section" id="lambda-the-ultimate">
<h2><a class="toc-backref" href="#id59">第八章: Lambda the Ultimate</a></h2>
<p>这一章才算开始高能, 下面的九,十章则更是要下一翻功夫了.
说高能, 并不是指有多难(除了连续概念的讲解),
而是指这一章揭示了很多更深入的东西, 更深入的抽象.</p>
<ul>
<li><p class="first">rember-f: 基本同rember, 但是其中的eq/equal比较函数,
当作参数传入进来, 具体的比较操作就抽象比来,
可以用来支持各种对象/类型的删除操作.
只需要你定义好其对象/类型的eq/equal比较函数即可.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">rember-f</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span> <span class="nv">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">rember-f</span> <span class="p">(</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>

<span class="c1">; 定义成为一个高阶函数</span>
<span class="p">(</span><span class="k">define </span><span class="nv">rember-f</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
       <span class="p">((</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
                   <span class="p">(</span><span class="nf">rember-f</span> <span class="p">(</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">rember-eq?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">rember-f</span> <span class="nv">eq?</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">rember-equal?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">rember-f</span> <span class="nv">equal?</span><span class="p">)))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">eq?-c: 返回一个函数, 用来与固定S表达式比较.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">eq?-c</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eq? </span><span class="nv">x</span> <span class="nv">a</span><span class="p">))))</span>

<span class="c1">; 与salad比较</span>
<span class="p">(</span><span class="k">define </span><span class="nv">eq?-salad</span>
<span class="p">(</span><span class="nf">eq?-c</span> <span class="ss">&#39;salad</span><span class="p">))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">insert-q: 返回一个函数, 具体的操作函数当作参数传入</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">seqL</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="nv">l</span><span class="p">))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">seqR</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">l</span><span class="p">))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">seqS</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">l</span><span class="p">)))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insert-g</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">seq</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
       <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
        <span class="p">(</span><span class="nf">seq</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
                   <span class="p">((</span><span class="nf">insert-g</span> <span class="nv">seq</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insertL</span>
  <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqL</span><span class="p">))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">insertR</span>
  <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqR</span><span class="p">))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">subst</span>
  <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqS</span><span class="p">))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">value: 重写之前的value, 将里面的操作抽象出来</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">atom-to-function</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="ss">&#39;+</span><span class="p">)</span> <span class="nv">+</span><span class="p">)</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="ss">&#39;*</span><span class="p">)</span> <span class="nv">*</span><span class="p">)</span>
     <span class="p">(</span><span class="k">else </span><span class="nv">^</span><span class="p">))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">value</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">((</span><span class="nf">atom-to-function</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multirember-f: 同上, 用test?代替eq?/equal?</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multirember-f</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">cond</span>
       <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
       <span class="p">((</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">multirember-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                   <span class="p">((</span><span class="nf">multirember-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multirember-eq?</span>
  <span class="p">(</span><span class="nf">multirember-f</span> <span class="nv">eq?</span><span class="p">))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multirember-equal?</span>
  <span class="p">(</span><span class="nf">multirember-f</span> <span class="nv">equal?</span><span class="p">))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multiremberT: 基本同上,
不过test?可以带参数，
将每次递归都不会变化的test?和a参数都存放到test?函数中.
以后写函数, 可以将哪些参数是不变的, 哪些参数是变化的区分开来.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multiremberT</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">multiremberT</span> <span class="nv">test?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                 <span class="p">(</span><span class="nf">multiremberT</span> <span class="nv">test?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multirember&amp;co: 将具体的操作放入col中
其中的col相当于一个收集器(collector),
它将lat中和a参数不相同的 放入col的第一个参数中,
相同的放入第二个参数中.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multirember&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">()))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">multirember&amp;co</span> <span class="nv">a</span>
                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">col</span> <span class="nv">newlat</span>
                             <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                                   <span class="nv">seen</span><span class="p">)))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">multirember&amp;co</span> <span class="nv">a</span>
                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
                                   <span class="nv">newlat</span><span class="p">)</span>
                             <span class="nv">seen</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">a-friend</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">null? </span><span class="nv">y</span><span class="p">)))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multiinsertLR: 将new插入到oldL的左边,oldR的右边.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertLR</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">oldL</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">oldL</span> <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">oldR</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cons </span><span class="nv">oldR</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">multiinsertLR&amp;co: 将具体的操作放入col中
col的newlat参数存放最后插入new参数后的newlat,
L参数是在oldL参数左边插入的次数, R参数是在oldR参数右边插入的次数.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertLR&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">oldL</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">multiinsertLR&amp;co</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">oldL</span> <span class="nv">newlat</span><span class="p">))</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">L</span><span class="p">)</span> <span class="nv">R</span><span class="p">))))</span>
     <span class="p">((</span><span class="nb">eq? </span><span class="nv">oldR</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">multiinsertLR&amp;co</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">oldR</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">newlat</span><span class="p">))</span> <span class="nv">L</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">R</span><span class="p">)))))</span>
     <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nf">multiinsertLR&amp;co</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">evens-only*: 找出嵌套队列中所有的偶数</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">; 此处要用之前定义的运算符号,用系统自带的会出错</span>
<span class="c1">; lisp支持分数, 即3/2不缺失其精度</span>
<span class="p">(</span><span class="k">define </span><span class="nv">even?</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">=_</span> <span class="p">(</span><span class="nf">*_</span> <span class="p">(</span><span class="nf">/_</span> <span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">n</span><span class="p">)))</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">evens-only*</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
      <span class="p">(</span><span class="nf">cond</span>
        <span class="p">((</span><span class="nb">even? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
         <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
               <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
        <span class="p">(</span><span class="nf">else</span>
          <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nf">else</span>
      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
            <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">evens-only*&amp;co: 将具体的操作放入col中</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">evens-only*&amp;co</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">col</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">col</span> <span class="o">&#39;</span><span class="p">()</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
       <span class="p">(</span><span class="nf">cond</span>
         <span class="p">((</span><span class="nb">even? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
                          <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">m</span> <span class="nv">s</span><span class="p">)</span>
                            <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">m</span><span class="p">)</span>
                                 <span class="nv">s</span><span class="p">))))</span>
         <span class="p">(</span><span class="nf">else</span>
           <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
                           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">m</span> <span class="nv">s</span><span class="p">)</span>
                           <span class="p">(</span><span class="nf">col</span> <span class="nv">newlat</span>
                                <span class="nv">m</span>
                                <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)))))))</span>
      <span class="p">(</span><span class="nf">else</span>
        <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
                       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">al</span> <span class="nv">am</span> <span class="nv">as</span><span class="p">)</span>
                         <span class="p">(</span><span class="nf">evens-only*&amp;co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
                                         <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">dl</span> <span class="nv">dm</span> <span class="nv">ds</span><span class="p">)</span>
                                           <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">al</span> <span class="nv">dl</span><span class="p">)</span>
                                                <span class="p">(</span><span class="nb">* </span><span class="nv">am</span> <span class="nv">dm</span><span class="p">)</span>
                                                <span class="p">(</span><span class="nb">+ </span><span class="nv">as</span> <span class="nv">ds</span><span class="p">))))))))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">这里建议一下，最好将从第二章开始的所有递归函数都用cps形式手动重写一遍</p>
</li>
</ul>
</div>
<div class="section" id="and-again-and-again-and-again">
<h2><a class="toc-backref" href="#id60">第九章: … and Again, and Again, and Again, …</a></h2>
<ul>
<li><p class="first">looking/keep-looking:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">looking</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">keep-looing</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">pick</span> <span class="mi">1</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">lat</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define </span><span class="nv">keep-looing</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">sorn</span> <span class="nv">lat</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">cond</span>
      <span class="p">((</span><span class="nb">number? </span><span class="nv">sorn</span><span class="p">)</span>
       <span class="p">(</span><span class="nf">keep-looking</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">pick</span> <span class="nv">sorn</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">lat</span><span class="p">))</span>
      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">sorn</span> <span class="nv">a</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">shift:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">shift</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pair</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))</span>
           <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))</span>
                  <span class="p">(</span><span class="nf">second</span> <span class="nv">pair</span><span class="p">)))))</span>
</pre></div>
</td></tr></table></li>
<li><p class="first">align:</p>
</li>
<li><p class="first">接下来讲的是停机理论和Y算子的概念, 基本都是理论上的东西</p>
</li>
</ul>
</div>
<div class="section" id="what-is-the-value-of-all-of-this">
<h2><a class="toc-backref" href="#id61">第十章: What Is the Value of All of This?</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-entry</span>
  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">entry</span> <span class="nv">entry-f</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">lookup-in-entry-help</span> <span class="nv">name</span>
                          <span class="p">(</span><span class="nf">first</span> <span class="nv">entry</span><span class="p">)</span>
                          <span class="p">(</span><span class="nf">second</span> <span class="nv">entry</span><span class="p">)</span>
                          <span class="nv">entry-f</span><span class="p">)))</span>
</pre></div>
</td></tr></table></div>

            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2014-06-22T00:00:00">Jun 22, 2014</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#scheme-ref">scheme</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags.html#guile-ref">guile
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#lisp-ref">lisp
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#scheme-ref">scheme
                    <span>11</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="http://www.htdp.org/" title="My HTDP Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-htdp sidebar-social-links"></i></a>
    <a href="http://mitpress.mit.edu/sicp/" title="My SICP Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-sicp sidebar-social-links"></i></a>
        </div>
        </section>
</div>
<!-- JiaThis Button BEGIN -->
<script type="text/javascript">
var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?move=0&amp;uid=1958900" charset="utf-8"></script>
<!-- JiaThis Button END -->

<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"chenjiee815"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
<!-- 多说公共JS代码 end -->
</article>

                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>