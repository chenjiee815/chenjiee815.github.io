<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TheLittleSchemer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Chen Jie">

    <!-- Le styles -->
    <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="/theme/css/font-awesome.css" rel="stylesheet">

    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png">

    <link href="/" type="application/atom+xml" rel="alternate" title="January Star ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">January Star </a>
          <div class="nav-collapse">
            <ul class="nav">
                          <li class="divider-vertical"></li>
                  <li class="active">
                    <a href="/category/xue-xi.html">
						<i class="icon-folder-open icon-large"></i>学习
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to TheLittleSchemer">
                                        TheLittleSchemer
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2014-06-22T00:00:00">
        <i class="icon-calendar"></i>日 22 六月 2014
</abbr>
<span class="label">By</span>
<a href="/author/chen-jie.html"><i class="icon-user"></i>Chen Jie</a>
<span class="label">Category</span>
<a href="/category/xue-xi.html"><i class="icon-folder-open"></i>学习</a>.


<span class="label">Tags</span>
	<a href="/tag/lisp.html"><i class="icon-tag"></i>lisp</a>
	<a href="/tag/scheme.html"><i class="icon-tag"></i>scheme</a>
	<a href="/tag/guile.html"><i class="icon-tag"></i>guile</a>
</footer><!-- /.post-info -->                </div>
                <div class="section" id="table-of-contents">
<h2>Table of Contents</h2>
<ul>
<li><ol class="first arabic simple">
<li>总纲</li>
</ol>
<blockquote>
<ul class="simple">
<li>1.1. scheme十戒</li>
<li>1.2. scheme五律</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="2">
<li>第一章: Toys</li>
</ol>
<blockquote>
<ul class="simple">
<li>2.1. 基本概念</li>
<li>2.2. 其它概念</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="3">
<li>第二章: Do It, Do It Again, and Again, and Again…</li>
</ol>
<blockquote>
<ul>
<li><p class="first">3.1. lat操作</p>
<blockquote>
<ul class="simple">
<li>3.1.1. 基本概念</li>
<li>3.1.2. 应用</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="4">
<li>第三章: Cons the Magnificent</li>
</ol>
<blockquote>
<ul>
<li><p class="first">4.1. lat操作</p>
<blockquote>
<ul class="simple">
<li>4.1.1. 应用</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="5">
<li>第四章: Numbers Games</li>
</ol>
<blockquote>
<ul>
<li><p class="first">5.1. 数字操作</p>
<blockquote>
<ul class="simple">
<li>5.1.1. 基本概念</li>
<li>5.1.2. 应用</li>
</ul>
</blockquote>
</li>
<li><p class="first">5.2. 综合操作</p>
</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="6">
<li>第五章: *Oh My Gawd*: It's Full of Stars</li>
</ol>
</li>
<li><ol class="first arabic simple" start="7">
<li>第六章: Shadows</li>
</ol>
<blockquote>
<ul class="simple">
<li>7.1. 应用</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="8">
<li>第七章: Friends and Relations</li>
</ol>
<blockquote>
<ul>
<li><p class="first">8.1. set操作</p>
<blockquote>
<ul class="simple">
<li>8.1.1. 基本概念</li>
<li>8.1.2. 应用</li>
</ul>
</blockquote>
</li>
<li><p class="first">8.2. pair操作</p>
<blockquote>
<ul class="simple">
<li>8.2.1. 基本概念</li>
<li>8.2.2. 应用</li>
</ul>
</blockquote>
</li>
<li><p class="first">8.3. rel操作</p>
<blockquote>
<ul class="simple">
<li>8.3.1. 基本概念</li>
</ul>
</blockquote>
</li>
<li><p class="first">8.4. fun操作</p>
<blockquote>
<ul class="simple">
<li>8.4.1. 基本概念</li>
<li>8.4.2. 应用</li>
</ul>
</blockquote>
</li>
<li><p class="first">8.5. fullfun操作</p>
<blockquote>
<ul class="simple">
<li>8.5.1. 基本概念</li>
<li>8.5.2. 应用</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li><ol class="first arabic simple" start="9">
<li>第八章: Lambda the Ultimate</li>
</ol>
</li>
<li><ol class="first arabic simple" start="10">
<li>第九章: … and Again, and Again, and Again, …</li>
</ol>
</li>
<li><ol class="first arabic simple" start="11">
<li>第十章: What Is the Value of All of This?</li>
</ol>
</li>
</ul>
</div>
<div class="section" id="id1">
<h2>1 总纲</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 87)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
1 总纲
----
</pre>
</div>
<div class="section" id="scheme">
<h3>1.1 scheme十戒</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 92)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
1.1 scheme十戒
~~~~~~~~~~~~
</pre>
</div>
<ol class="arabic">
<li><p class="first">当对一个原子列表进行递归时，要注意两个问题：(null? lat) and else。
当对一个数字进行递归时，要注意两个问题：(zero? n) and else。 当对一个S表达式列表进行递归时，要注意三个问题：(null?
l), (atom? (car l)) 和 else。</p>
</li>
<li><p class="first">使用cons来创建列表。</p>
</li>
<li><p class="first">当创建一个列表时，先描述第一个元素，然后用cons来将它和递归连接在一起</p>
</li>
<li><p class="first">递归时，至少要改变一个参数。 例如：递归一个原子列表使用(cdr lat)；递归一个数字使用(sub1 n)；
递归一个S表达式时，如果这个表达式即不(null? l)，也不(atom? (car l))， 那么使用(car l) 和 (cdr l)。
\ 并且该参数必须要越来越接近终止元素。在终止条件里面必须要对正在变化的参数进行检查：</p>
<blockquote>
<ul class="simple">
<li>当使用cdr时，终止条件使用null?</li>
<li>当使用sub1时，终止条件使用zero?</li>
</ul>
</blockquote>
</li>
<li><p class="first">当你使用+来创建一个值时，必须总要用0来作为终止，0加上任何值都不会改变原来的值。
当你使用*来创建一个值时，必须总要用1来作为终止，1乘以任务值都不会改变原来的值。
当你使用cons来创建一个值时，必须总要用()来作为终止。</p>
</li>
<li><p class="first">当函数运行正确后再考虑简化函数。</p>
</li>
<li><p class="first">当一个对象的子对象是与其本身表现一致时，这时候可用递归操作。比如：</p>
<blockquote>
<ul class="simple">
<li>一个列表的子列表</li>
<li>一个算术表达式的子表达式</li>
</ul>
</blockquote>
</li>
<li><p class="first">使用help函数来简化表述。</p>
</li>
<li><p class="first">使用新的函数来抽象公共模式。</p>
</li>
<li><p class="first">创建函数时，尽量能够一次性获取更多的值。</p>
</li>
</ol>
</div>
<div class="section" id="id2">
<h3>1.2 scheme五律</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 124)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
1.2 scheme五律
~~~~~~~~~~~~
</pre>
</div>
<ol class="arabic simple">
<li>car函数最初只是用在非空列表上的。</li>
<li>cdr函数最初只是用在非空列表上的，(cdr non-null-list)的结果是另一个列表。</li>
<li>cons函数最初只接受两个参数，第二个参数必须是一个列表，它返回的结果也是一个列表。</li>
<li>null?函数只对列表有用。</li>
<li>eq?函数只接受两个参数，两个参数必须都是非数字的原子。</li>
</ol>
</div>
</div>
<div class="section" id="toys">
<h2>2 第一章: Toys</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 137)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
2 第一章: Toys
-----------
</pre>
</div>
<p>作者目的：使读者了解scheme一些基本概念和一些常用函数，为接下来的章节打基础。</p>
<div class="section" id="id3">
<h3>2.1 基本概念</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 144)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
2.1 基本概念
~~~~~~~~
</pre>
</div>
<ul class="simple">
<li>S表达式: scheme中所以元素都可以叫做S表达式。</li>
<li>atom: 原子，是指一个非列表的S表达式。</li>
<li>list: 列表，用()包围起来的S表达式。</li>
<li>car: 返回非空列表中的首个S表达式， 所以它操作的对象一定要是非空的列表(十戒第一条)。</li>
<li>cdr: 取出非空列表中的除首个S表达式的列表， 它操作的对象也是要非空列表(十戒第一条)。</li>
<li>cons: 将两个S表达式连接成一个列表，第二个必须是一个列表。</li>
<li>null?: 只判断列表是否为空(scheme五律第四条)。</li>
<li>atom?: 用来判断一个S表达式是否为一个原子。</li>
</ul>
<pre class="literal-block">
(define atom?
  (lambda (m)
      (and (not (pair? m)) (not (null? m)))))
</pre>
<ul class="simple">
<li>eq?: 用来判断两个非数字的的原子是否相等， (PS: guile的实现不太一样，它还可以比较数字。)</li>
</ul>
</div>
<div class="section" id="id4">
<h3>2.2 其它概念</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 170)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
2.2 其它概念
~~~~~~~~
</pre>
</div>
<ul class="simple">
<li>define: 用来定义一个名称，或者一个函数。</li>
<li>lambda: 用来定义一个函数。</li>
<li>cond: 相当于其它语言中的switch。</li>
<li>else: 永远返回#t, 即True。</li>
</ul>
</div>
</div>
<div class="section" id="do-it-do-it-again-and-again-and-again">
<h2>3 第二章: Do It, Do It Again, and Again, and Again…</h2>
<div class="section" id="lat">
<h3>3.1 lat操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 187)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
3.1 lat操作
~~~~~~~~~
</pre>
</div>
<div class="section" id="id5">
<h4>3.1.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 192)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
3.1.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>lat: 列表中包含的每个S表达式都是原子的列表。</li>
</ul>
</div>
<div class="section" id="id6">
<h4>3.1.2 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 201)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
3.1.2 应用
````````
</pre>
</div>
<ul class="simple">
<li>lat?: 判断列表中是否每个S表达式都是原子。</li>
</ul>
<pre class="literal-block">
(define lat?
  (lambda (l)
    (cond
      ((null? l) #t)
      ((atom? (car l)) (lat? (cdr l)))
      (else #f))))
</pre>
<pre class="literal-block">
(define col
  (lambda (lat nolat)
    (null? nolat)))

(define lat?&amp;co
  (lambda (l col)
    (cond
     ((null? l) (col '() '()))
     ((atom? (car l)) (lat?&amp;co (cdr l) (lambda (lat nolat)
                                         (col (cons (car l) lat) nolat))))
     (else lat?&amp;co (cdr l) (lambda (lat nolat)
                             (col lat (cons (car l) nolat)))))))
</pre>
<ul class="simple">
<li>member?: 用来判断一个S表达式是否在一个列表之内。</li>
</ul>
<pre class="literal-block">
(define member?
  (lambda (a lat)
    (cond
     ((null? lat) #f)
     ((eq? a (car lat)) #t)
     (else (member? a (cdr lat))))))

; CPS变换
(define col
  (lambda (in out)
    (not (null? in))))

(define member?&amp;co
  (lambda (a lat col)
    (cond
      ((null? lat) #f)
      ((eq? a (car lat)) (member?&amp;co a (cdr lat) (lambda (in out)
                                                   (col (cons a in) out))))
      (else (member?&amp;co a (cdr lat) (lambda (in out)
                                      (col in (cons a out))))))))
</pre>
</div>
</div>
</div>
<div class="section" id="cons-the-magnificent">
<h2>4 第三章: Cons the Magnificent</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 268)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
4 第三章: Cons the Magnificent
---------------------------
</pre>
</div>
<div class="section" id="id7">
<h3>4.1 lat操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 273)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
4.1 lat操作
~~~~~~~~~
</pre>
</div>
<div class="section" id="id8">
<h4>4.1.1 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 278)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
4.1.1 应用
````````
</pre>
</div>
<ul class="simple">
<li>rember: 将一个S表达式从一个列表中删除。</li>
</ul>
<pre class="literal-block">
(define rember
  (lambda (a lat)
    (cond
     ((null? lat) '())
     ((eq? a (car lat)) (cdr lat))
     (else (cons (car lat) (rember a (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (rmcount leftlat)
    (display rmcount)
    (newline)
    (display leftlat)
    (newline)
    leftlat))

(define rember&amp;co
  (lambda (a lat col)
    (cond
     ((null? lat) (col 0 '()))
     ((eq? a (car lat)) (col 1 (cdr lat)))
     (else (rember&amp;co a (cdr lat) (lambda (rmcount leftlat)
                                    (col rmcount (cons (car lat) leftlat))))))))
</pre>
<ul class="simple">
<li>firsts: 从一个列表中的获取其每个子列表的首个S表达式，并以列表形式返回</li>
</ul>
<pre class="literal-block">
(define firsts
  (lambda (l)
    (cond
     ((null? l) '())
     (else (cons (car (car l)) (firsts (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (first_ed)
    (display first_ed)
    (newline)
    first_ed))

(define firsts&amp;co
  (lambda (l col) (display l) (newline)
    (cond
     ((null? l) (col '()))
     (else (firsts&amp;co (cdr l) (lambda (first_ed)
                               (col (cons (car (car l)) first_ed))))))))
</pre>
<ul class="simple">
<li>insertR: 将一个S表达式插入到一个列表中指定S表达式的右边，并返回修改后的列表 insertL: 基本同上，只不过是插入到左边
注意：insert*函数的整体逻辑与rember是差不多的。</li>
</ul>
<pre class="literal-block">
(define insertR
  (lambda (new old lat)
    (cond
     ((null? lat) '())
     ((eq? old (car lat)) (cons old (cons new (cdr lat))))
     (else (cons (car lat) (insertR new old (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (newlat)
    (display newlat)
    (newline)
    newlat))

(define insertR&amp;co
  (lambda (new old lat col)
    (cond
     ((null? lat) (col '()))
     ((eq? old (car lat))
        (col (cons old (cons new (cdr lat)))))
     (else (insertR&amp;co new old (cdr lat) (lambda (newlat)
                                           (col (cons (car lat) newlat) )))))))
</pre>
<pre class="literal-block">
(define insertL
  (lambda (new old lat)
    (cond
     ((null? lat) '())
     ((eq? old (car lat)) (cons new lat))
     (else (cons (car lat) (insertL new old (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (newlat)
    (display newlat)
    (newline)
    newlat))

(define insertL&amp;co
  (lambda (new old lat col)
    (cond
     ((null? lat) (col '()))
     ((eq? old (car lat)) (col (cons new lat)))
     (else (insertL&amp;co new old (cdr lat) (lambda (newlat)
                                           (col (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>subst: 用新的S表达式替代列表中指定的S表达式，并返回修改后的列表 subst2: 用来替代列表中指定的两个S表达式
注意：subst*函数的整体逻辑也与rember是差不多的。</li>
</ul>
<pre class="literal-block">
(define subst
  (lambda (new old lat)
    (cond
     ((null? lat) '())
     ((eq? old (car lat)) (cons new (cdr lat)))
     (else (cons (car lat) (subst new old (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (newlat)
    (display newlat)
    (newline)
    newlat))

(define subst&amp;co
  (lambda (new old lat col)
    (cond
     ((null? lat) (col '()))
     ((eq? old (car lat))
      (col (cons new (cdr lat))))
     (else (subst&amp;co new old (cdr lat) (lambda (newlat)
                                         (col (cons (car lat) newlat))))))))
</pre>
<pre class="literal-block">
(define subst2
  (lambda (new old1 old2 lat)
    (cond
     ((null? lat) '())
     ((eq? old1 (car lat)) (cons new (cdr lat)))
     ((eq? old2 (car lat)) (cons new (cdr lat)))
     (else (cons (car lat) (subst2 new old1 old2 (cdr lat)))))))

;subst2简化版本
(define subst2
  (lambda (new old1 old2 lat)
    (cond
     ((null? lat) '())
     ((or (eq? old2 (car lat))
          (eq? old1 (car lat)))
      (cons new (cdr lat)))
     (else (cons (car lat) (subst2 new old1 old2 (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (newlat)
    (display newlat)
    (newline)
    newlat))

(define subst2&amp;co
  (lambda (new old1 old2 lat col)
    (cond
     ((null? lat) (col '()))
     ((or (eq? old1 (car lat)) (eq? old2 (car lat)))
      (col (cons new (cdr lat))))
     (else (subst&amp;co new old1 old2 (cdr lat) (lambda (newlat)
                                               (col (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>multirember: 基本同rember, 只不过是列表中所有符合的S表达式都会删除.
注意：其逻辑基本是在rember逻辑上进行扩充的。</li>
</ul>
<pre class="literal-block">
(define multirember
  (lambda (a lat)
    (cond
     ((null? lat) '())
     ((eq? a (car lat)) (multirember a (cdr lat)))
     (else (cons (car lat) (multirember a (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (rmcount newlat)
    (display rmcount)
    (display &quot; &quot;)
    (display newlat)
    (newline)
    newlat))

(define multirember&amp;co
  (lambda (a lat col)
    (cond
     ((null? lat) (col 0 '()))
     ((eq? a (car lat))
      (multirember&amp;co a (cdr lat) (lambda (rmcount newlat)
                                    (col (+ rmcount 1) newlat))))
     (else
      (multirember&amp;co a (cdr lat) (lambda (rmcount newlat)
                                    (col rmcount (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>multiinsertR: 基本同insertR, 只不过是列表中所有符合的s表达式都会插入其右边。
注意：其逻辑基本是在insertR逻辑上进行扩充的。</li>
</ul>
<pre class="literal-block">
(define multiinsertR
  (lambda (new old lat)
    (cond
     ((null? lat) '())
     ((eq? old (car lat))
      (cons old (cons new (multiinsertR new old (cdr lat)))))
     (else (cons (car lat) (multiinsertR new old (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (inscount newlat)
    (display inscount)
    (display &quot; &quot;)
    (display newlat)
    (newline)
    newlat))

(define multiinsertR&amp;co
  (lambda (new old lat col)
    (cond
     ((null? lat) (col 0 '()))
     ((eq? old (car lat))
        (multiinsertR&amp;co new old (cdr lat) (lambda (inscount newlat)
                                             (col (+ inscount 1) (cons old (cons new newlat))))))
     (else
        (multiinsertR&amp;co new old (cdr lat) (lambda (inscount newlat)
                                             (col inscount (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>multiinsertL: 基本同insertL, 只不过是列表中所有符合的s表达式都会插入其左边.
注意：其逻辑基本是在insertL逻辑上进行扩充的。</li>
</ul>
<pre class="literal-block">
(define multiinsertL
  (lambda (new old lat)
    (cond
     ((null? lat) '())
     ((eq? old (car lat))
      (cons new (cons old (multiinsertL new old (cdr lat)))))
     (else (cons (car lat) (multiinsertL new old (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (inscount newlat)
    (display inscount)
    (display &quot; &quot;)
    (display newlat)
    (newline)
    newlat))

(define mutlinsertL&amp;co
  (lambda (new old lat col)
    (cond
     ((null? lat) (col 0 '()))
     ((eq? old (car lat))
      (mutlinsertL&amp;co new old (cdr lat) (lambda (inscount newlat)
                                          (col (+ inscount 1)
                                               (cons new (cons old newlat))))))
     (else
      (mutlinsertL&amp;co new old (cdr lat) (lambda (inscount newlat)
                                          (col inscount
                                               (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>multisubst: 基本同sbust, 只不过是列表中所有符合的s表达式都替换</li>
</ul>
<pre class="literal-block">
(define multisubst
  (lambda (new old lat)
    (cond
     ((null? lat) '())
     ((eq? old (car lat))
      (cons new (multisubst new old (cdr lat))))
     (else (cons (car lat) (multisubst new old (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (stcount newlat)
    (display stcount)
    (display &quot; &quot;)
    (display newlat)
    (newline)
    newlat))

(define mutlsubst&amp;co
  (lambda (new old lat col)
    (cond
     ((null? lat) (col 0 '()))
     ((eq? old (car lat))
      (mutlisubst&amp;co new old (cdr lat) (lambda (inscount newlat)
                                          (col (+ inscount 1)
                                               (cons new newlat)))))
     (else
      (mutlisubst&amp;co new old (cdr lat) (lambda (inscount newlat)
                                          (col inscount
                                               (cons (car lat) newlat))))))))
</pre>
</div>
</div>
</div>
<div class="section" id="numbers-games">
<h2>5 第四章: Numbers Games</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 663)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
5 第四章: Numbers Games
--------------------
</pre>
</div>
<div class="section" id="id9">
<h3>5.1 数字操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 668)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
5.1 数字操作
~~~~~~~~
</pre>
</div>
<div class="section" id="id10">
<h4>5.1.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 673)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
5.1.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>数字也是一个atom</li>
<li>number?: 判断一个S表达式是否为数字</li>
<li>tup: 列表中包含的每个s表达式都是数字的列表。</li>
</ul>
</div>
<div class="section" id="id11">
<h4>5.1.2 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 684)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
5.1.2 应用
````````
</pre>
</div>
<ul class="simple">
<li>add1: 对数字加1</li>
<li>sub1: 对数字减1</li>
<li>+: 将两个数字相加</li>
</ul>
<pre class="literal-block">
(define +
  (lambda (a b)
    (cond
     ((zero? b) a)
     (else (add1 (+ a (sub1 b)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define myadd&amp;co
  (lambda (a b col)
    (cond
    ((zero? b) (col a))
    (else (myadd&amp;co a (- b 1) (lambda (num)
                                (col (+ num 1))))))))
</pre>
<ul class="simple">
<li>-: 将两个数字相减</li>
</ul>
<pre class="literal-block">
(define -
  (lambda (a b)
    (cond
     ((zero? b) a)
     (else (sub1 (- a (sub1 b)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define mysub&amp;co
  (lambda (a b col)
    (cond
     ((zero? b) (col a))
     (else (mysub&amp;co (- a 1) (- b 1) col)))))
</pre>
<ul class="simple">
<li>addtup: 一个tup中的所有数字相加</li>
</ul>
<pre class="literal-block">
(define addtup
  (lambda (tup)
    (cond
     ((null? tup) 0)
     (else (+ (car tup) (addtup (cdr tup)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define addtup&amp;co
  (lambda (tup col)
    (cond
     ((null? tup) (col 0))
     (else
      (addtup&amp;co (cdr tup) (lambda (sum)
                             (col (+ sum (car tup)))))))))
</pre>
<ul>
<li><p class="first"><a href="#id12"><span class="problematic" id="id13">*</span></a>: 将两个数字相乘</p>
<div class="system-message" id="id12">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 785); <em><a href="#id13">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</div>
</li>
</ul>
<pre class="literal-block">
(define *
  (lambda (n m)
    (cond
     ((zero? m) 0)
     (else (+ n (* n (sub1 m)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define mymulti&amp;co
  (lambda (n m col)
    (cond
     ((zero? m) (col 0))
     (else (mymulti&amp;co n (- m 1) (lambda (num)
                                   (+ num n)))))))
</pre>
<ul class="simple">
<li>tup+: 将两个tup中相对的数字相加,然后返回相加后的tup</li>
</ul>
<pre class="literal-block">
; 该函数允许两个参数的长度不一样
(define tup+
  (lambda (tup1 tup2)
    (cond
     ((null? tup2) tup1)
     ((null? tup1) tup2)
     (else (cons (+_ (car tup1) (car tup2))
                     (tup+ (cdr tup1) (cdr tup2)))))))

; 该函数的两个参数长度必须一样
(define tup+
  (lambda (tup1 tup2)
    (cond
     ((and (null? tup1) (null? tup2)) '())
     (else (cons (+_ (car tup1) (car tup2))
                 (tup+ (cdr tup1) (cdr tup2)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (newtup)
    (display newtup)
    (newline)
    newtup))

(define tup+&amp;co
  (lambda (tup1 tup2 col)
    (cond
     ((null? tup1) (col tup2))
     ((null? tup2) (col tup1))
     (else (tup+&amp;co (cdr tup1) (cdr tup2) (lambda (newtup)
                                            (col (cons (+ (car tup1) (car tup2)) newtup))))))))
</pre>
<ul class="simple">
<li>&lt;: 比较两个数字的大小 &gt;: 比较两个数字的大小</li>
</ul>
<pre class="literal-block">
(define &gt;
  (lambda (n m)
    (cond
     ((zero? n) #f)
     ((zero? m) #t)
     (else (&gt; (sub1 n) (sub1 m))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define mylt&amp;co
  (lambda (n m col)
    (cond
     ((zero? n) (col #f))
     ((zero? m) (col #t))
     (else (mylt&amp;co (- n 1) (- m 1) col)))))
</pre>
<pre class="literal-block">
(define &lt;
  (lambda (n m)
    (cond
     ((zero? m) #f)
     ((zero? n) #t)
     (else (&lt; (sub1 n) (sub1 m))))))
;基本同上
</pre>
<ul class="simple">
<li>=: 比较两个数字是否相等</li>
</ul>
<pre class="literal-block">
(define =
  (lambda (n m)
    (cond
     ((zero? m) (zero? n))
     ((zero? n) #f)
     (else (= (sub1 n) (sub1 m))))))

(define =
  (lambda (n m)
    (cond
     ((&gt; n m) #f)
     ((&lt; n m) #f)
     (else #t))))
</pre>
<ul class="simple">
<li>^: 阶乘</li>
</ul>
<pre class="literal-block">
(define ^
  (lambda (n m)
    (cond
     ((zero? n) 0)
     ((zero? m) 1)
     (else (* n (^ n (sub1 m)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define mypower&amp;co
  (lambda (n m col)
    (cond
     ((zero? n) (col 0))
     ((zero? m) (col 1))
     (else (mypower&amp;co n (- m 1) (lambda (num)
                                   (col (* n num))))))))
</pre>
<ul class="simple">
<li>/: 除</li>
</ul>
<pre class="literal-block">
(define /
  (lambda (n m)
    (cond
     ((&lt; n m) 0)
     (else (add1 (/ (- n m) m))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define mydiv&amp;co
  (lambda (n m col)
    (cond
     ((&lt; n m) (col 0))
     (else (mydiv&amp;co (- n m) m (lambda (num)
                                 (col (+ num 1))))))))
</pre>
</div>
</div>
<div class="section" id="id14">
<h3>5.2 综合操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 997)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
5.2 综合操作
~~~~~~~~
</pre>
</div>
<ul class="simple">
<li>length: 返回一个lat的长度</li>
</ul>
<pre class="literal-block">
(define length
  (lambda (lat)
    (cond
     ((null? lat) 0)
     (else (add1 (length (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define length&amp;co
  (lambda (lat col)
    (cond
     ((null? lat) (col 0))
     (else (length&amp;co (cdr lat) (lambda (num)
                                  (col (+ num 1))))))))
</pre>
<ul class="simple">
<li>pick: 根据传入的数字,获取其对应在lat中位置的S表达式</li>
</ul>
<pre class="literal-block">
(define pick
  (lambda (n lat)
    (cond
     ((zero? (sub1 n)) (car lat))
     (else (pick (sub1 n) (cdr lat))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define pick&amp;co
  (lambda (n lat col)
    (cond
     ((null? lat) (col '()))
     ((zero? (- n 1)) (col (car lat)))
     (else (pick&amp;co (- n 1) (cdr lat) col)))))
</pre>
<ul class="simple">
<li>rempick: 根据传入的数字, 删除其对应在lat中位置的S表达式,并返回剩余列表</li>
</ul>
<pre class="literal-block">
(define rempick
  (lambda (n lat)
    (cond
     ((null? lat) '())
     ((zero? (sub1 n)) (cdr lat))
     (else (cons (car lat) (rempick (sub1 n) (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define rempick&amp;co
  (lambda (n lat col)
    (cond
     ((null? lat) (col '()))
     ((zero? (- n 1)) (col (cdr lat)))
     (else (rempick&amp;co (- n 1) (cdr lat) (lambda (newlat)
                                           (col (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>no-nums: 选出列表中的非数字S表达式, 并以列表形式返回</li>
</ul>
<pre class="literal-block">
(define no-nums
  (lambda (lat)
    (cond
     ((null? lat) '())
     ((number? (car lat)) (no-nums (cdr lat)))
     (else (cons (car lat) (no-nums (cdr lat)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define nonum&amp;co
  (lambda (lat col)
    (cond
     ((null? lat) (col '()))
     ((number? (car lat))
      (nonum&amp;co (cdr lat) col))
     (else (nonum&amp;co (cdr lat) (lambda (newlat)
                                 (col (cons (car lat) newlat))))))))
</pre>
<ul class="simple">
<li>all-nums: 跟上面相反, 只返回数字列表</li>
</ul>
<pre class="literal-block">
(define all-nums
  (lambda (lat)
    (cond
     ((null? lat) '())
     ((not (number? (car lat))) (all-nums (cdr lat)))
     (else (cons (car lat) (all-nums (cdr lat)))))))

;逻辑基本同上
</pre>
<ul class="simple">
<li>eqan?: 比较两个S表达式是否是相等</li>
</ul>
<pre class="literal-block">
(define eqan?
  (lambda (a1 a2)
    (cond
     ((and (number? a1) (number? a2))
      (= a1 a2))
     ((or (number? a1) (number? a2))
      #f)
     (else (eq? a1 a2)))))
</pre>
<ul class="simple">
<li>occur?: 检查列表中有几个指定的S表达式</li>
</ul>
<pre class="literal-block">
(define occur
  (lambda (a lat)
    (cond
     ((null? lat) 0)
     ((eqan? a (car lat))
      (add1 (occur a (cdr lat))))
     (else (occur a (cdr lat))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define occur&amp;co
  (lambda (n lat col)
    (cond
     ((null? lat) (col 0))
     ((eq? n (car lat))
      (occur&amp;co n (cdr lat) (lambda (num)
                              (col (+ num 1)))))
     (else
      (occur&amp;co n (cdr lat) col)))))
</pre>
<ul class="simple">
<li>one?: 判断一个数字是否为1</li>
</ul>
<pre class="literal-block">
(define one?
  (lambda (n)
    (cond
     ((zero? n) #f)
     (else (zero? (sub1 n))))))

(define one?
  (lambda (n)
    (cond
     (else (=_ n 1)))))
</pre>
</div>
</div>
<div class="section" id="oh-my-gawd-it-s-full-of-stars">
<h2>6 第五章: *Oh My Gawd*: It's Full of Stars</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1225)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
6 第五章: \*Oh My Gawd\*: It's Full of Stars
-----------------------------------------
</pre>
</div>
<ul class="simple">
<li>rember*: 基本同rember, 但其处理的对象包括一个嵌套的列表</li>
</ul>
<pre class="literal-block">
(define rember*
  (lambda (a l)
    (cond
     ((null? l) '())
     ((atom? (car l))
      (cond
       ((eq? a (car l))
        (rember* a (cdr l)))
       (else (cons (car l) (rember* a (cdr l))))))
     (else (cons (rember* a (car l))
                 (rember* a (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define rember*&amp;co
  (lambda (a l col)
    (cond
     ((null? l) (col '()))
     ((atom? (car l))
      (cond
       ((eq? a (car l))
        (rember*&amp;co a (cdr l) col))
       (else
        (rember*&amp;co a (cdr l) (lambda (newl)
                                (col (cons (car l) newl)))))))
     (else
      (rember*&amp;co a (car l) (lambda (carl)
                              (rember*&amp;co a (cdr l) (lambda (cdrl)
                                                       (col (cons carl cdrl))))))))))
</pre>
<ul class="simple">
<li>insertR*: 基本同insertR, 但其处理的对象包括一个嵌套的列表</li>
</ul>
<pre class="literal-block">
(define insertR*
  (lambda (new old l)
    (cond
     ((null? l) '())
     ((atom? (car l))
      (cond
       ((eq? old (car l))
        (cons old (cons new (insertR* new old (cdr l)))))
       (else (cons (car l) (insertR* new old (cdr l))))))
     (else (cons (insertR* new old (car l))
                 (insertR* new old (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define insertR*&amp;co
  (lambda (new old l col)
    (cond
     ((null? l) (col '()))
     ((atom? (car l))
      (cond
       ((eq? old (car l))
        (insertR*&amp;co new old (cdr l) (lambda (newl)
                                       (col (cons old (cons new newl))))))
       (else
        (insertR*&amp;co new old (cdr l) (lambda (newl)
                                       (col (cons (car l) newl)))))))
     (else
      (insertR*&amp;co new old (car l) (lambda (carl)
                                     (insertR*&amp;co new old (cdr l) (lambda (cdrl)
                                                                    (col (cons carl cdrl))))))))))
</pre>
<ul class="simple">
<li>occur*: 基本同occur, 但其处理的对象包括一个嵌套的列表</li>
</ul>
<pre class="literal-block">
(define occur*
  (lambda (a l)
    (cond
     ((null? l) 0)
     ((atom? (car l))
      (cond
       ((eq? a (car l))
        (add1 (occur* a (cdr l))))
       (else (occur* a (cdr l)))))
     (else (+_ (occur* a (car l))
                (occur* a (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define occur*&amp;co
  (lambda (a l col)
    (cond
     ((null? l) (col 0))
     ((atom? (car l))
      (cond
       ((eq? a (car l))
        (occur*&amp;co a (cdr l) (lambda (num)
                               (col (+ num 1)))))
       (else
        (occur*&amp;co a (cdr l) col))))
     (else
      (occur*&amp;co a (car l) (lambda (carnum)
                             (occur*&amp;co a (cdr l) (lambda (cdrnum)
                                                    (col (+ carnum cdrnum))))))))))
</pre>
<ul class="simple">
<li>subst*: 基本同subst, 但其处理的对象包括一个嵌套的列表</li>
</ul>
<pre class="literal-block">
(define subst*
  (lambda (new old l)
    (cond
     ((null? l) '())
     ((atom? (car l))
      (cond
       ((eq? old (car l))
        (cons new (subst* new old (cdr l))))
       (else (cons (car l) (subst* new old (cdr l))))))
     (else (cons (subst* new old (car l))
                 (subst* new old (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define subst*&amp;co
  (lambda (new old l col)
    (cond
     ((null? l) (col l))
     ((atom? (car l))
      (cond
       ((eq? old (car l))
        (subst*&amp;co new old (cdr l) (lambda (newl)
                                     (col (cons new newl)))))
       (else
        (subst*&amp;co new old (cdr l) (lambda (newl)
                                     (col (cons (car l) newl)))))))
     (else
      (subst*&amp;co new old (car l) (lambda (carl)
                                   (subst*&amp;co new old (cdr l) (lambda (cdrl)
                                                                (col (cons carl cdrl))))))))))
</pre>
<ul class="simple">
<li>insertL*: 基本同insertL, 但其处理的对象包括一个嵌套的列表</li>
</ul>
<pre class="literal-block">
(define insertL*
  (lambda (new old l)
    (cond
     ((null? l) '())
     ((atom? (car l))
      (cond
       ((eq? old (car l))
        (cons new (cons old (insertL* new old (cdr l)))))
       (else (cons (car l) (insertL* new old (cdr l))))))
     (else (cons (insertL* new old (car l))
                 (insertL* new old (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define insertL*&amp;co
  (lambda (new old l col)
    (cond
     ((null? l) (col l))
     ((atom? (car l))
      (cond
       ((eq? old (car l))
        (insertL*&amp;co new old (cdr l) (lambda (newl)
                                       (col (cons new (cons old newl))))))
       (else
        (insertL*&amp;co new old (cdr l) (lambda (newl)
                                       (col (cons old newl)))))))
     (else
      (insertL*&amp;co new old (car l) (lambda (carl)
                                     (insertL*&amp;co new old (cdr l) (lambda (cdrl)
                                                                    (col (cons carl cdrl))))))))))
</pre>
<ul class="simple">
<li>member*: 基本同member, 但其处理的对象包括一个嵌套的列表</li>
</ul>
<pre class="literal-block">
(define member*
  (lambda (a l)
    (cond
     ((null? l) #f)
     ((atom? a (car l))
      (cond
       ((eq? a (car l)) #t)
       (else (member* a (cdr l)))))
     (else (or (member* a (car l))
               (member* a (cdr l)))))))
</pre>
<pre class="literal-block">
(define col
  (lambda (num)
    (display num)
    (newline)
    num))

(define member*&amp;co
  (lambda (a l col)
    (cond
     ((null? l) (col #f))
     ((atom? (car l))
      (cond
       ((eq? a (car l))
        (col #t))
       (else
        (member*&amp;co a (cdr l) col))))
     (else
      (member*&amp;co a (car l) (lambda (incar)
                              (member*&amp;co a (cdr l) (lambda (incdr)
                                                      (col (or incar incdr))))))))))
</pre>
<ul class="simple">
<li>leftmost: 找出不包含空列表的列表/嵌套列表中的最左边的一个atom</li>
</ul>
<pre class="literal-block">
(define leftmost
  (lambda (l)
    (cond
     ((atom? (car l)) (car l))
     (else (leftmost (car l))))))
</pre>
<ul class="simple">
<li>eqlist?: 判断两个列表/嵌套列表是否相同
注意：作者通过equal?来简化了eqlist?，而且equal?也是通过eqlist?来实现的。 只当函数正确的前提下再进行简化/优化。</li>
</ul>
<pre class="literal-block">
(define eqlist?
  (lambda (l1 l2)
    (cond
     ((and (null? l1) (null? l2)) #t)
     ((and (null? l1) (atom? (car l2))) #f)
     ((null? l1) #f)
     ((and (atom? (car l1)) (null? l2)) #f)
     ((and (atom? (car l1)) (atom? (car l2)))
      (and (eqan? (car l1) (car l2))
           (eqlist? (cdr l1) (cdr l2))))
     ((atom? (car l1)) #f)
     ((null? l2) #f)
     ((atom? (car l2)) #f)
     (else
      (and (eqlist? (car l1) (car l2))
           (eqlist? (cdr l1) (cdr l2)))))))

(define eqlist?
  (lambda (l1 l2)
    (cond
     ((and (null? l1) (null? l2)) #t)
     ((or (null? l1) (null? l2)) #f)
     ((and (atom? (car l1))
           (atom? (car l2)))
      (and (eqan? (car l1) (car l2))
           (eqlist? (cdr l1) (cdr l2))))
     ((or (atom? (car l1))
          (atom? (car l2))) #f)
     (else (and (eqlist? (car l1) (car l2))
                (eqlist? (cdr l1) (cdr l2)))))))
</pre>
<pre class="literal-block">
(define equal?
  (lambda (s1 s2)
    (cond
     ((and (atom? s1) (atom? s2))
      (eqan? s1 s2))
     ((or (atom? s1) (atom? s2)) #f)
     (else (eqlist? s1 s2)))))
</pre>
<pre class="literal-block">
(define eqlist?
  (lambda (l1 l2)
    (cond
     ((and (null? l1) (null? l2)) #t)
     ((or (null? l1) (null? l2)) #f)
     (else
      (and (equal? (car l1) (car l2))
           (eqlist? (cdr l1) (cdr l2)))))))
</pre>
<ul class="simple">
<li>rember: 重写之前简单的rember, 参数s代表任何S表达式,参数l代码任何列表</li>
</ul>
<pre class="literal-block">
(define rember
  (lambda (s l)
    (cond
     ((null? l) '())
     ((equal? s (car l)) (cdr l))
     (else (cons (car l) (rember s (cdr l)))))))
</pre>
</div>
<div class="section" id="shadows">
<h2>7 第六章: Shadows</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1609)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
7 第六章: Shadows
--------------
</pre>
</div>
<p>这一章讲的是有关算术表达式的相关内容, 它通过帮助函数来 支持前缀中缀后缀算术表达式. 但我这里只写了前缀表达式的代码.</p>
<div class="section" id="id15">
<h3>7.1 应用</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1616)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
7.1 应用
~~~~~~
</pre>
</div>
<ul class="simple">
<li>判断一个S表达式是否为算术表达式</li>
</ul>
<pre class="literal-block">
(define numbered?
  (lambda (aexp)
    (cond
     ((atom? aexp) (number? aexp))
     ((or (eq? (car (cdr aexp)) '+)
          (eq? (car (cdr aexp)) '*)
          (eq? (car (cdr aexp)) '^))
      (and (numberd? (car aexp))
           (numberd? (car (cdr (cdr aexp))))))
     (else #f))))
</pre>
<ul class="simple">
<li>^: 倍数</li>
</ul>
<pre class="literal-block">
(define ^
  (lambda (n m)
    (expt n m)))
</pre>
<ul class="simple">
<li>value: 获取一个算术表达式的值</li>
</ul>
<pre class="literal-block">
(define value
  (lambda (nexp)
    (cond
     ((atom? nexp) nexp)
     ((eq? (car nexp) '+)
      (+ (value (cdr nexp))
         (value (cdr (cdr nexp)))))
     ((eq? (car nexp) '*)
      (* (value (cdr nexp))
         (value (cdr (cdr nexp)))))
     (else (^ (value (cdr nexp))
              (value (cdr (cdr nexp))))))))

; 帮助函数
(define 1st-sub-exp
  (lambda (aexp)
    (car (cdr aexp))))

; 帮助函数
(define 2nd-sub-exp
  (lambda (aexp)
    (car (cdr (cdr aexp)))))

; 帮助函数
(define operator
  (lambda (aexp)
    (car aexp)))

; 使用帮助函数重写的value函数
; 这样修改后的函数, 其实即可以用在前缀,也可以用在后缀表达式上
; 只要修改几个帮助函数即可
(define value
  (lambda (nexp)
    (cond
     ((atom? nexp) nexp)
     ((eq? (operator nexp) '+)
      (+ (value (1st-sub-exp nexp))
         (value (2nd-sub-exp nexp))))
     ((eq? (operator nexp) '*)
      (* (value (1st-sub-exp nexp))
         (value (2nd-sub-exp))))
     (else (^ (value (1st-sub-exp nexp))
              (value (2nd-sub-exp nexp)))))))
</pre>
<ul class="simple">
<li>接下来作者用()来表示0, (())表示1, (() ())表示2… 然后定义了对应的原语函数: sero?, edd1,
zub1,</li>
</ul>
</div>
</div>
<div class="section" id="friends-and-relations">
<h2>8 第七章: Friends and Relations</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1709)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8 第七章: Friends and Relations
----------------------------
</pre>
</div>
<div class="section" id="set">
<h3>8.1 set操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1714)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.1 set操作
~~~~~~~~~
</pre>
</div>
<div class="section" id="id16">
<h4>8.1.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1719)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.1.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>set: 集合, 类似于列表, 但是它其中的元素唯一</li>
</ul>
</div>
<div class="section" id="id17">
<h4>8.1.2 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1728)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.1.2 应用
````````
</pre>
</div>
<ul class="simple">
<li>set?: 判断一个S表达式是否为set</li>
</ul>
<pre class="literal-block">
(define set?
  (lambda (lat)
    (cond
     ((null? lat) #t)
     ((member? (car lat) (cdr lat)) #f)
     (else (set? (cdr lat))))))
</pre>
<ul class="simple">
<li>makeset: 生成一个set</li>
</ul>
<pre class="literal-block">
(define makeset
  (lambda (lat)
    (cond
     ((null? lat) '())
     ((member? (car lat) (cdr lat))
      (makeset (cdr lat)))
     (else (cons (car lat) (makeset (cdr lat)))))))

;使用multirember, 另外一种思路
(define makeset
  (lambda (lat)
    (cond
     ((null? lat) '())
     (else (cons (car lat)
                 (makeset (multirember (car lat)
                                       (cdr lat))))))))
</pre>
<ul class="simple">
<li>subset?: 判断set1是否是set2的子集</li>
</ul>
<pre class="literal-block">
(define subset?
  (lambda (set1 set2)
    (cond
     ((null? set1) #t)
     ((member? (car set1) set2)
      (subset? (cdr set1) set2))
     (else #f))))

(define subset?
  (lambda (set1 set2)
    (cond
     ((null? set1) #t)
     ((and (member? (car set1) set2)
           (subset? (cdr set1) set2))))))
</pre>
<ul class="simple">
<li>eqset?: 判断两个set是否相等</li>
</ul>
<pre class="literal-block">
(define eqset?
  (lambda (set1 set2)
    ((and (subset? set1 set2)
          (subset? set2 set1)))))
</pre>
<ul class="simple">
<li>interset?: 判断set1是否至少有一个S表达式在set2中</li>
</ul>
<pre class="literal-block">
(define intersect?
  (lambda (set1 set2)
    (cond
     ((null? set1) #t)
     ((member? (car set1) set2) #t)
     (else (intersect? (cdr set1) set2)))))

(define intersect?
  (lambda (set1 set2)
    (cond
     ((null? set1) #t)
     ((or (member? (car set1) set2)
          (intersect? (cdr set1) set2))))))
</pre>
<ul class="simple">
<li>interset: 求两个set的交集</li>
</ul>
<pre class="literal-block">
(define intersect
  (lambda (set1 set2)
    (cond
     ((or (null? set1)
          (null? set2))
      '())
     ((member? (car set1) set2)
      (cons (car set1)
            (intersect (cdr set1) set2)))
     (else (intersect (cdr set1) set2)))))
</pre>
<ul class="simple">
<li>union: 求两个set的并集</li>
</ul>
<pre class="literal-block">
(define union
  (lambda (set1 set2)
    (cond
     ((null? set1) set2)
     ((null? set2) set1)
     ((member? (car set1) set2)
      (union (cdr set1) set2))
     (else (cons (car set1)
                 (union (cdr set1) set2))))))
</pre>
<ul class="simple">
<li>intersectall: 获取set中每个子set的交集</li>
</ul>
<pre class="literal-block">
(define intersectall
  (lambda (l-set)
    (cond
     ((null? (cdr l-set)) (car l-set))
     (else (intersect (car l-set)
                      (intersectall (cdr l-set)))))))
</pre>
</div>
</div>
<div class="section" id="pair">
<h3>8.2 pair操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1883)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.2 pair操作
~~~~~~~~~~
</pre>
</div>
<div class="section" id="id18">
<h4>8.2.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1888)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.2.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>pair: 点对, 只包含两个S表达式的列表</li>
</ul>
</div>
<div class="section" id="id19">
<h4>8.2.2 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1897)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.2.2 应用
````````
</pre>
</div>
<ul class="simple">
<li>a-pair?: 判断一个S表达式是否为pair</li>
</ul>
<pre class="literal-block">
(define a-pair?
  (lambda (x)
    (cond
     ((atom? x) #f)
     ((null? x) #f)
     ((null? (cdr lat) #f))
     ((null? (cdr (cdr lat))) #t)
     (else #f))))
</pre>
<ul class="simple">
<li>first: 获取pair的第一个S表达式</li>
</ul>
<pre class="literal-block">
(define first
  (lambda (p)
    (car p)))
</pre>
<ul class="simple">
<li>second: 获取pair的第二个S表达式</li>
</ul>
<pre class="literal-block">
(define second
  (lambda (p)
    (car (cdr p))))
</pre>
<ul class="simple">
<li>build: 生成一个pair</li>
</ul>
<pre class="literal-block">
(define build
  (lambda (s1 s2)
    (cons s1 (cons s2 '()))))
</pre>
</div>
</div>
<div class="section" id="rel">
<h3>8.3 rel操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1955)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.3 rel操作
~~~~~~~~~
</pre>
</div>
<div class="section" id="id20">
<h4>8.3.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1960)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.3.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>rel: 是一个内部嵌套pair的list, 但是其所有子pair是唯一的</li>
</ul>
</div>
</div>
<div class="section" id="fun">
<h3>8.4 fun操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1969)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.4 fun操作
~~~~~~~~~
</pre>
</div>
<div class="section" id="id21">
<h4>8.4.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1974)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.4.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>fun: 同rel, 但其所有子pair的第一个元素也是唯一的, 类似于字典(key-&gt;value)</li>
</ul>
</div>
<div class="section" id="id22">
<h4>8.4.2 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 1983)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.4.2 应用
````````
</pre>
</div>
<ul class="simple">
<li>fun?: 判断一个S表达式是否为fun</li>
</ul>
<pre class="literal-block">
(define fun?
  (lambda (rel)
    (set? (firsts rel))))
</pre>
<ul class="simple">
<li>revrel: 将fun中所有子pair的两个元素对调</li>
</ul>
<pre class="literal-block">
(define revrel
  (lambda (rel)
    ((null? rel) '())
    (else (cons (build (second (car rel))
                       (first (car rel)))
                (revrel (cdr rel))))))

; 如果将其中的pair中两元素对调写成一个单独的函数
; 则revrel看起来会更简洁明了
(define revpair
  (lambda (pair)
    (build (second pair)
           (first pair))))

(define revrel
  (lambda (rel)
    ((null? rel) '())
    (else (cons (revpair (car rel))
                (revrel (cdr rel))))))
</pre>
</div>
</div>
<div class="section" id="fullfun">
<h3>8.5 fullfun操作</h3>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 2028)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.5 fullfun操作
~~~~~~~~~~~~~
</pre>
</div>
<div class="section" id="id23">
<h4>8.5.1 基本概念</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 2033)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.5.1 基本概念
``````````
</pre>
</div>
<ul class="simple">
<li>fullfun: 基本同fun, 但其所有子pair的第二个元素也是唯一的</li>
</ul>
</div>
<div class="section" id="id24">
<h4>8.5.2 应用</h4>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 2042)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
8.5.2 应用
````````
</pre>
</div>
<ul class="simple">
<li>fullfun?: 判断一个S表达式是否为fullfun</li>
</ul>
<pre class="literal-block">
(define fullfun?
  (lambda (fun)
    (set? (seconds fun))))

(define fullfun?
  (lambda (fun)
    (fun? (revrel fun))))
</pre>
</div>
</div>
</div>
<div class="section" id="lambda-the-ultimate">
<h2>9 第八章: Lambda the Ultimate</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 2063)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
9 第八章: Lambda the Ultimate
--------------------------
</pre>
</div>
<p>这一章才算开始高能, 下面的九,十章则更是要下一翻功夫了.
说高能, 并不是指有多难(除了连续概念的讲解),
而是指这一章揭示了很多更深入的东西, 更深入的抽象.</p>
<ul class="simple">
<li>rember-f: 基本同rember, 但是其中的eq/equal比较函数, 当作参数传入进来, 具体的比较操作就抽象比来,
可以用来支持各种对象/类型的删除操作. 只需要你定义好其对象/类型的eq/equal比较函数即可.</li>
</ul>
<pre class="literal-block">
(define rember-f
  (lambda (test? a l)
    (cond
     ((null? l) '())
     ((test? a (car l)) (cdr l))
     (else (cons (car l)
                 (rember-f (test? a (cdr l))))))))

; 定义成为一个高阶函数
(define rember-f
  (lambda (test?)
    (lambda (a l)
      (cond
       ((null? l) '())
       ((test? a (car l)) (cdr l))
       (else (cons (car l)
                   (rember-f (test? a (cdr l)))))))))

(define rember-eq?
  (lambda (a l)
    (rember-f eq?)))

(define rember-equal?
  (lambda (a l)
    (rember-f equal?)))
</pre>
<ul class="simple">
<li>eq?-c: 返回一个函数, 用来与固定S表达式比较.</li>
</ul>
<pre class="literal-block">
(define eq?-c
  (lambda (a)
    (lambda (x)
      (eq? x a))))

; 与salad比较
(define eq?-salad
(eq?-c 'salad))
</pre>
<ul class="simple">
<li>insert-q: 返回一个函数, 具体的操作函数当作参数传入</li>
</ul>
<pre class="literal-block">
(define seqL
  (lambda (new old l)
    (cons new (cons old l))))
</pre>
<pre class="literal-block">
(define seqR
  (lambda (new old l)
    (cons old (cons new l))))
</pre>
<pre class="literal-block">
(define seqS
  (lambda (new old l)
    (cons new l)))
</pre>
<pre class="literal-block">
(define insert-g
  (lambda (seq)
    (lambda (new old l)
      (cond
       ((null? l) '())
       ((eq? (car l) old)
        (seq new old (cdr l)))
       (else (cons (car l)
                   ((insert-g seq) new old (cdr l))))))))
</pre>
<pre class="literal-block">
(define insertL
  (insert-g seqL))
</pre>
<pre class="literal-block">
(define insertR
  (insert-g seqR))
</pre>
<pre class="literal-block">
(define subst
  (insert-g seqS))
</pre>
<ul class="simple">
<li>value: 重写之前的value, 将里面的操作抽象出来</li>
</ul>
<pre class="literal-block">
(define atom-to-function
  (lambda (x)
    (cond
     ((eq? x '+) +)
     ((eq? x '*) *)
     (else ^))))
</pre>
<pre class="literal-block">
(define value
  (lambda (nexp)
    (cond
     ((atom? nexp) nexp)
     (else
      ((atom-to-function (operator nexp))
       (value (1st-sub-exp nexp))
       (value (2nd-sub-exp nexp)))))))
</pre>
<ul class="simple">
<li>multirember-f: 同上, 用test?代替eq?/equal?</li>
</ul>
<pre class="literal-block">
(define multirember-f
  (lambda (test?)
    (lambda (a lat)
      (cond
       ((null? lat) '())
       ((test? a (car lat))
        ((multirember-f test?) a (cdr lat)))
       (else (cons (car lat)
                   ((multirember-f test?) a (cdr lat))))))))
</pre>
<pre class="literal-block">
(define multirember-eq?
  (multirember-f eq?))
</pre>
<pre class="literal-block">
(define multirember-equal?
  (multirember-f equal?))
</pre>
<ul class="simple">
<li>multiremberT: 基本同上, 不过test?可以带参数 将每次递归都不会变化的test?和a参数都存放到test?函数中.
以后写函数, 可以将哪些参数是不变的, 哪些参数是变化的区分开来.</li>
</ul>
<pre class="literal-block">
(define multiremberT
  (lambda (test? lat)
    (cond
     ((null? lat) '())
     ((test? (car lat))
      (multiremberT test? (cdr lat)))
     (else (cons (car lat)
                 (multiremberT test? (cdr lat)))))))
</pre>
<ul class="simple">
<li>multirember&amp;co: 将具体的操作放入col中 其中的col相当于一个收集器(collector),
它将lat中和a参数不相同的 放入col的第一个参数中, 相同的放入第二个参数中.</li>
</ul>
<pre class="literal-block">
(define multirember&amp;co
  (lambda (a lat col)
    (cond
     ((null? lat)
      (col '() '()))
     ((eq? (car lat) a)
      (multirember&amp;co a
                      (cdr lat)
                      (lambda (newlat seen)
                        (col newlat
                             (cons (car lat)
                                   seen)))))
     (else
      (multirember&amp;co a
                      (cdr lat)
                      (lambda (newlat seen)
                        (col (cons (car lat)
                                   newlat)
                             seen)))))))
</pre>
<pre class="literal-block">
(define a-friend
  (lambda (x y)
    (null? y)))
</pre>
<ul class="simple">
<li>multiinsertLR: 将new插入到oldL的左边,oldR的右边.</li>
</ul>
<pre class="literal-block">
(define multiinsertLR
  (lambda (new oldL oldR lat)
    (cond
     ((null? lat) '())
     ((eq? oldL (car lat))
      (cons new (cons oldL (multiinsertLR new oldL oldR (cdr lat)))))
     ((eq? oldR (car lat))
      (cons oldR (cons new (multiinsertLR new oldL oldR (cdr lat)))))
     (else
      (cons (car lat) (multiinsertLR new oldL oldR (cdr lat)))))))
</pre>
<ul class="simple">
<li>multiinsertLR&amp;co: 将具体的操作放入col中 col的newlat参数存放最后插入new参数后的newlat,
L参数是在oldL参数左边插入的次数, R参数是在oldR参数右边插入的次数.</li>
</ul>
<pre class="literal-block">
(define multiinsertLR&amp;co
  (lambda (new oldL oldR lat col)
    (cond
     ((null? lat)
      (col '() 0 0))
     ((eq? oldL (car lat))
      (multiinsertLR&amp;co new oldL oldR (cdr lat)
                        (lambda (newlat L R)
                          (col (cons new (cons oldL newlat)) (add1 L) R))))
     ((eq? oldR (car lat))
      (multiinsertLR&amp;co new oldL oldR (cdr lat)
                        (lambda (newlat L R)
                          (col (cons oldR (cons new newlat)) L (add1 R)))))
     (else
      (multiinsertLR&amp;co new oldL oldR (cdr lat)
                        (lambda (newlat L R)
                          (col (car lat) L R)))))))
</pre>
<ul class="simple">
<li>evens-only*: 找出嵌套队列中所有的偶数</li>
</ul>
<pre class="literal-block">
; 此处要用之前定义的运算符号,用系统自带的会出错
; lisp支持分数, 即3/2不缺失其精度
(define even?
  (lambda (n)
    (=_ (*_ (/_ n 2) 2) n)))
</pre>
<pre class="literal-block">
(define evens-only*
  (lambda (l)
    ((null? l) '())
    ((atom? (car l))
     (cond
      ((even? (car l))
       (cons (car l)
             (evens-only* (cdr l))))
      (else
       (evens-only* (cdr l)))))
    (else
     (cons (evens-only* (car l))
           (evens-only* (cdr l))))))
</pre>
<ul class="simple">
<li>evens-only*&amp;co: 将具体的操作放入col中</li>
</ul>
<pre class="literal-block">
(define evens-only*&amp;co
  (lambda (l col)
    ((null? l)
     (col '() 1 0))
    ((atom? (car l))
     (cond
      ((even? (car l))
       (evens-only*&amp;co (cdr l)
                       (lambda (newlat m s)
                         (col (cons (car l) newlat)
                              (* (car l) m)
                              s))))
      (else
       (evens-only*&amp;co (cdr l)
                       (lambda (newlat m s)
                         (col newlat
                              m
                              (+ (car l) s)))))))
    (else
     (evens-only*&amp;co (car l)
                     (lambda (al am as)
                       (evens-only*&amp;co (cdr l)
                                       (lambda (dl dm ds)
                                         (col (cons al dl)
                                              (* am dm)
                                              (+ as ds))))))))
</pre>
<ul class="simple">
<li>这里建议一下，最好将从第二章开始的所有递归函数都用cps形式手动重写一遍</li>
</ul>
</div>
<div class="section" id="and-again-and-again-and-again">
<h2>10 第九章: … and Again, and Again, and Again, …</h2>
<ul class="simple">
<li>looking/keep-looking:</li>
</ul>
<pre class="literal-block">
(define looking
  (lambda (a lat)
    (keep-looing a (pick 1 lat) lat)))

(define keep-looing
  (lambda (a sorn lat)
    (cond
     ((number? sorn)
      (keep-looking a (pick sorn lat) lat))
     (else (eq? sorn a)))))
</pre>
<ul class="simple">
<li>shift:</li>
</ul>
<pre class="literal-block">
(define shift
  (lambda (pair)
    (build (first (first pair))
           (build (second (first pair))
                  (second pair)))))
</pre>
<ul class="simple">
<li>align:</li>
<li>接下来讲的是停机理论和Y算子的概念, 基本都是理论上的东西</li>
</ul>
</div>
<div class="section" id="what-is-the-value-of-all-of-this">
<h2>11 第十章: What Is the Value of All of This?</h2>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">/media/cj/self/git/chenjiee815_blogs/chenjiee815_blogs/content/2014/06/the_little_schemer_note.rst</tt>, line 2469)</p>
<p>Title underline too short.</p>
<pre class="literal-block">
11 第十章: What Is the Value of All of This?
-----------------------------------------
</pre>
</div>
<pre class="literal-block">
(define lookup-in-entry
  (lambda (name entry entry-f)
    (lookup-in-entry-help name
                          (first entry)
                          (second entry)
                          entry-f)))
</pre>
<p>Author: Chen Jie</p>
<p>Created: 2014-06-22 日 16:13</p>
<p><a class="reference external" href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a class="reference external" href="http://orgmode.org">Org</a> mode 8.2.7a)</p>
<p><a class="reference external" href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>

                </div><!-- /.entry-content -->
                <div class="comments">
                <h2>Comments !</h2>
                        <div id="disqus_thread"></div>
                        <script type="text/javascript">
                           var disqus_identifier = "thelittleschemer.html";
                           (function() {
                                var dsq = document.createElement('script');
                                dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = 'http://chenjiee815blog.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] ||
                                 document.getElementsByTagName('body')[0]).appendChild(dsq);
                          })();
                        </script>
                </div>
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="http://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="http://python.org/"><i class="icon-external-link"></i>Python.org</a></li>
    <li><a href="http://jinja.pocoo.org/"><i class="icon-external-link"></i>Jinja2</a></li>
    <li><a href="#"><i class="icon-external-link"></i>You can modify those links in your config file</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="/" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="#"><i class="icon-You can add links in your config file-sign icon-large"></i>You can add links in your config file</a></li>
    <li><a href="#"><i class="icon-Another social link-sign icon-large"></i>Another social link</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="/category/xue-xi.html">
    <i class="icon-folder-open icon-large"></i>学习
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<li class="tag-4">
    <a href="/tag/guile.html">
        <i class="icon-tag icon-large"></i>guile
    </a>
</li>
<li class="tag-4">
    <a href="/tag/restructuredtext.html">
        <i class="icon-tag icon-large"></i>reStructuredText
    </a>
</li>
<li class="tag-4">
    <a href="/tag/setuptools.html">
        <i class="icon-tag icon-large"></i>setuptools
    </a>
</li>
<li class="tag-4">
    <a href="/tag/blog.html">
        <i class="icon-tag icon-large"></i>blog
    </a>
</li>
<li class="tag-1">
    <a href="/tag/python.html">
        <i class="icon-tag icon-large"></i>python
    </a>
</li>
<li class="tag-2">
    <a href="/tag/pip.html">
        <i class="icon-tag icon-large"></i>pip
    </a>
</li>
<li class="tag-4">
    <a href="/tag/lisp.html">
        <i class="icon-tag icon-large"></i>lisp
    </a>
</li>
<li class="tag-4">
    <a href="/tag/pelican.html">
        <i class="icon-tag icon-large"></i>pelican
    </a>
</li>
<li class="tag-4">
    <a href="/tag/scheme.html">
        <i class="icon-tag icon-large"></i>scheme
    </a>
</li>
<li class="tag-4">
    <a href="/tag/markdown.html">
        <i class="icon-tag icon-large"></i>MarkDown
    </a>
</li>
<li class="tag-2">
    <a href="/tag/package.html">
        <i class="icon-tag icon-large"></i>package
    </a>
</li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->


<script type="text/javascript">
    var disqus_shortname = 'chenjiee815blog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/theme/js/jquery-1.7.2.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>