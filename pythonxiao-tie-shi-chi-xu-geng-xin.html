<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Chen Jie" />
        <meta name="copyright" content="Chen Jie" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="python, tip, python, " />

<meta property="og:title" content="Python小贴士（持续更新） "/>
<meta property="og:url" content="http://chenjiee815.github.io/pythonxiao-tie-shi-chi-xu-geng-xin.html" />
<meta property="og:description" content="Contents next unicode iter memoryview NotImplemented 与 NotImplementedError NotImplemented NotImplementedError 真值判断 () 的用法 1.bit_length() 为啥会报错？ 获取当前模块对象 startswith&amp;&amp;endswith 这里记录的是我用 Python 几年以来，觉得大家可能会忽略的的小知识点（好吧，也有可能只是我自己忽略的小知识点）。 next next 是 Python 提供的一个 Built-in 函数。 提到 next，大家可能都会想到 Python 中的迭代协议中就有要求实现一个 next 方法。 那这个函数的功能也是作用于一个迭代器的。 1next(iterator[, default]) 看到它的函数签名了么，有一个 default 可选参数，这个就是我想要讲的重点。 next 在检索一个迭代器 ..." />
<meta property="og:site_name" content="January Star" />
<meta property="og:article:author" content="Chen Jie" />
<meta property="og:article:published_time" content="2014-10-03T10:37:41.950917" />
<meta name="twitter:title" content="Python小贴士（持续更新） ">
<meta name="twitter:description" content="Contents next unicode iter memoryview NotImplemented 与 NotImplementedError NotImplemented NotImplementedError 真值判断 () 的用法 1.bit_length() 为啥会报错？ 获取当前模块对象 startswith&amp;&amp;endswith 这里记录的是我用 Python 几年以来，觉得大家可能会忽略的的小知识点（好吧，也有可能只是我自己忽略的小知识点）。 next next 是 Python 提供的一个 Built-in 函数。 提到 next，大家可能都会想到 Python 中的迭代协议中就有要求实现一个 next 方法。 那这个函数的功能也是作用于一个迭代器的。 1next(iterator[, default]) 看到它的函数签名了么，有一个 default 可选参数，这个就是我想要讲的重点。 next 在检索一个迭代器 ...">

        <title>Python小贴士（持续更新）  · January Star
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://chenjiee815.github.io/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://chenjiee815.github.io/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://chenjiee815.github.io/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="http://chenjiee815.github.io/theme/css/custom.css" media="screen">
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-52167018-1', 'auto');
    ga('send', 'pageview');
</script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <div class="span1"></div>
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="http://chenjiee815.github.io/"><span class=site-name>January Star</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href="http://chenjiee815.github.io">Home</a></li>
                            <li ><a href="http://chenjiee815.github.io/categories.html">Categories</a></li>
                            <li ><a href="http://chenjiee815.github.io/tags.html">Tags</a></li>
                            <li ><a href="http://chenjiee815.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="http://chenjiee815.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="http://chenjiee815.github.io/pythonxiao-tie-shi-chi-xu-geng-xin.html"> Python小贴士（持续更新）  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#next" id="id4">next</a></li>
<li><a class="reference internal" href="#unicode" id="id5">unicode</a></li>
<li><a class="reference internal" href="#iter" id="id6">iter</a></li>
<li><a class="reference internal" href="#memoryview" id="id7">memoryview</a></li>
<li><a class="reference internal" href="#notimplementednotimplementederror" id="id8">NotImplemented 与 NotImplementedError</a><ul>
<li><a class="reference internal" href="#notimplemented" id="id9">NotImplemented</a></li>
<li><a class="reference internal" href="#notimplementederror" id="id10">NotImplementedError</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1" id="id11"> 真值判断 </a></li>
<li><a class="reference internal" href="#id2" id="id12">() 的用法 </a></li>
<li><a class="reference internal" href="#bit-length" id="id13">1.bit_length() 为啥会报错？</a></li>
<li><a class="reference internal" href="#id3" id="id14"> 获取当前模块对象 </a></li>
<li><a class="reference internal" href="#startswith-endswith" id="id15">startswith&amp;&amp;endswith</a></li>
</ul>
</div>
<hr class="docutils" />
<p> 这里记录的是我用 Python 几年以来，觉得大家可能会忽略的的小知识点（好吧，也有可能只是我自己忽略的小知识点）。</p>
<div class="section" id="next">
<h2><a class="toc-backref" href="#id4">next</a></h2>
<p>next 是 Python 提供的一个 Built-in 函数。</p>
<p> 提到 next，大家可能都会想到 Python 中的迭代协议中就有要求实现一个 next 方法。</p>
<p> 那这个函数的功能也是作用于一个迭代器的。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">[,</span> <span class="n">default</span><span class="p">])</span>
</pre></div>
</td></tr></table><p> 看到它的函数签名了么，有一个 default 可选参数，这个就是我想要讲的重点。</p>
<pre class="literal-block">
next 在检索一个迭代器（不是一个可迭代的对象）时，会调用它的 next() 方法，
但当迭代器迭代结束时，如果提供了 default 参数，next 函数会返回 default,
如果没有，则直接抛出 StopIteration 异常。
</pre>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"> 注意我上面所强调的 <strong> 迭代器 </strong> 和 <strong> 可迭代对象 </strong> 的区分。</p>
</div>
<p> 它对应的 Python 代码实现如下（实际上以 C 语言实现）：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">onlyone</span> <span class="o">=</span> <span class="n">Object</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">onlyone</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">iterator</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">default</span> <span class="o">!=</span> <span class="n">onlyone</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
</pre></div>
</td></tr></table><p> 我想要的就是永远不要一个迭代器抛出 StopIteration 异常。</p>
<p> 比如下面这种使用场景（来自 string 标准库源码学习）：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">_ASCII_COUNT</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">_IDMAP</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">_ASCII_COUNT</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">maketrans</span><span class="p">(</span><span class="n">fromstr</span><span class="p">,</span> <span class="n">tostr</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fromstr</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tostr</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="s">&quot;maketrans arguments must have same length&quot;</span>
    <span class="n">frm_to</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fromstr</span><span class="p">,</span> <span class="n">tostr</span><span class="p">)</span>
    <span class="c"># 如果字符 C 在 fromstr 中，则替换为 tostr 中对应 index 的字符 </span>
    <span class="c"># 否则返回字符 C 本身 </span>
    <span class="n">sub_c</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="nb">next</span><span class="p">((</span><span class="n">t</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">frm_to</span> <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="n">c</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">sub_c</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_IDMAP</span><span class="p">))</span>
</pre></div>
</td></tr></table><p> 我就是想要 <cite>(t for f, t in frm_to if f == c)</cite> 这个生成器（迭代器之一），在 <cite>f == c</cite> 时立即给我返回值，如果没有则直接返回 <cite>c</cite> 。</p>
<p> 这种情况，正常的 <cite>for</cite> 格式代码很容易实现：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sub_c</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">frm_to</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">c</span>
</pre></div>
</td></tr></table><p> 但有些人就是有点小强迫症（比如我）：一行可实现的代码，干嘛写那么啰嗦。</p>
</div>
<div class="section" id="unicode">
<h2><a class="toc-backref" href="#id5">unicode</a></h2>
<p> 嗯，这也是一个 Python 的内置函数。函数签名如下：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">unicode</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="nb">unicode</span><span class="p">(</span><span class="nb">object</span><span class="p">[,</span> <span class="n">encoding</span><span class="p">[,</span> <span class="n">errors</span><span class="p">]])</span>
</pre></div>
</td></tr></table><p> 我想要讲还是 unicode 的可选参数 <cite>errors</cite> 。</p>
<p><cite>errors</cite> 这个可选参数有三个值 <cite>strict</cite> 、 <cite>ignore</cite>  、 <cite>replace</cite></p>
<p> 当我们用 unicode 函数将一个对象转换成 unicode 字符串时，如果遇到无法解析的字符，unicode 就会根据 errors 的值来决定如何处理该异常。</p>
<p>strict</p>
<blockquote>
默认的行为，直接抛出 <cite>ValueError</cite></blockquote>
<p>ingore</p>
<blockquote>
忽略无法解析的字符，并继续解析 </blockquote>
<p>replace</p>
<blockquote>
用 <cite>U+FFFD</cite> 来代替该字符，并继续解析 </blockquote>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last"> 一个字符串的 <cite>decode</cite> 方法和 <cite>encode</cite> 方法也支持 <cite>errors</cite> 参数。</p>
</div>
</div>
<div class="section" id="iter">
<h2><a class="toc-backref" href="#id6">iter</a></h2>
<p> 还是 Python 的内置函数，直接看它的签名。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">iter</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iterator</span>
<span class="nb">iter</span><span class="p">(</span><span class="nb">callable</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iterator</span>
</pre></div>
</td></tr></table><p> 第一种用法大家应该都了解的，这里我想说一下第二种用法。</p>
<p>iter 函数会不停地调用第一个参数 callable，直到该 callable 的返回值等于 sentinel（哨兵），它就会抛出 StopIteration 异常。</p>
<p> 该用法很类似于 <cite>itertools.takewhile</cite> 。</p>
</div>
<div class="section" id="memoryview">
<h2><a class="toc-backref" href="#id7">memoryview</a></h2>
<p> 这个类是在 Python2.7 中才加入的。</p>
<p> 这个类可以用来访问一个支持 buffer 协议的对象的内部数据，而不需要拷贝这些数据。可以用在对内存比较敏感的地方。</p>
<p> 目前 Python 内置的支持 buffer 协议的有 str 和 bytearry。</p>
<p> 比如：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">str_a</span> <span class="o">=</span> <span class="s">&quot;abcdefg&quot;</span>
<span class="n">mem_a</span> <span class="o">=</span> <span class="n">memoryview</span><span class="p">(</span><span class="n">str_a</span><span class="p">)</span>
<span class="n">tag</span> <span class="o">=</span> <span class="s">&quot;bcdefg&quot;</span>

<span class="k">print</span> <span class="n">str_a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="n">tag</span> <span class="c"># 第 1 种情况 </span>
<span class="k">print</span> <span class="n">mem_a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="n">tag</span> <span class="c"># 第 2 种情况 </span>
</pre></div>
</td></tr></table><p> 第 1 种情况 Python 会使用切片操作生成一个字符串 <cite>&quot;bcdefg&quot;</cite> ，然后再跟 <cite>tag</cite> 进行比较。</p>
<p> 第 2 种情况 Python 只会生成一个新的 memoryview 对象再然后再跟 <cite>tag</cite> 进行比较。该新的 memoryview 对象本质是对 <cite>str_a</cite> 的 <cite>bcdefg</cite> 段的引用，并不生成新的字符串。</p>
</div>
<div class="section" id="notimplementednotimplementederror">
<h2><a class="toc-backref" href="#id8">NotImplemented 与 NotImplementedError</a></h2>
<div class="section" id="notimplemented">
<h3><a class="toc-backref" href="#id9">NotImplemented</a></h3>
<p> 为一个内置的常量。</p>
<p> 常用于 “ 富比较 ” 的特殊方法（ <cite>__eq__</cite> 、 <cite>__lt__</cite>  等其它方法）的返回值，用于说明该方法未实现。</p>
</div>
<div class="section" id="notimplementederror">
<h3><a class="toc-backref" href="#id10">NotImplementedError</a></h3>
<p> 为一个内置异常，是从 <cite>RuntimeError</cite> 继承的。</p>
<p> 多用于用户自定义的抽象方法中，用户可以在自定义的抽象方法中抛出该异常，要求继承该方法所在类的子类实现该方法。</p>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id11"> 真值判断 </a></h2>
<p> 在 Python 中使用 bool 函数、if、while 等对某个对象进行真值判断时，有一定的算法。</p>
<ol class="arabic simple">
<li> 以下情况则为 False<ul>
<li>None</li>
<li>False</li>
<li> 所有为 0 的数值，比如：0, 0L, 0.0, 0j</li>
<li> 任何空的序列，比如： '', (), []</li>
<li> 任何空的映射，比如 {}</li>
<li> 用户定义的类的实例：如果该类定义了 ** <cite>__nonzero__</cite> ** 或者 ** <cite>__len__</cite> ** 方法，且返回值为数值 0 或者 False</li>
</ul>
</li>
<li> 其它所有情况都为 True</li>
</ol>
<p> 其实真值判断在 Python 入门时，大家都有遇到过，基本对于前 6 种会被判定为 False，大家也都清楚。</p>
<p> 但是最后一种会被判断为 False，忽略的人可能会比较多。</p>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id12">() 的用法 </a></h2>
<p> 在 Python 中，很多人还了解到元组的生成语法后，就会以为 <cite>()</cite> 是元组专享的。</p>
<p> 其实在 Python 中， <cite>()</cite> 真实的意思应该是组合，一般情况下有它无它都可以。</p>
<p> 比如：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="p">(</span><span class="s">&quot;abcd&quot;</span> <span class="s">&quot;ABC&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="s">&#39;abcdABC&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="mi">1</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="p">(</span><span class="s">&quot;adfi&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="s">&#39;adfi&#39;</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="s">&quot;asdfi&quot;</span> <span class="s">&quot;asdif&quot;</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="s">&#39;asdfiasdif&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="mi">1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="mi">1</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="s">&quot;adfi&quot;</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="s">&#39;adfi&#39;</span>
</pre></div>
</td></tr></table><p> 如果在 <cite>()</cite> 的内部至少有一个 <cite>,</cite> 才会解释成元组，或者啥都没有，就是一个空元组。</p>
<p> 大家想深入了解的话，可以看 Python 官方文档 <a class="reference external" href="https://docs.python.org/2/reference/expressions.html#parenthesized-forms">Parenthesized forms</a> 。</p>
</div>
<div class="section" id="bit-length">
<h2><a class="toc-backref" href="#id13">1.bit_length() 为啥会报错？</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="mf">1.</span><span class="n">bit_length</span><span class="p">()</span>
  <span class="n">File</span> <span class="s">&quot;&lt;ipython-input-25-069f7d2f7d97&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span>
    <span class="mf">1.</span><span class="n">bit_length</span><span class="p">()</span>
               <span class="o">^</span>
<span class="ne">SyntaxError</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">syntax</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="mf">1.</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="mf">1.0</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="bp">True</span>
</pre></div>
</td></tr></table><p>Python 里面不是是一切皆对象么，为啥我大浮点数可以调用方法，整数就不可以，还报语法错？</p>
<blockquote>
其实这个由于 Python 的语法解析器导致的。</blockquote>
<p> 当它解释到 <cite>[number][dot]</cite> 这种形式时，它会将之当作一个浮点数，你一个浮点后面直接加方法名，中间没有 <cite>.</cite> 当然就直接报语法错了。</p>
<p><cite>1..is_integer()</cite> 这样的话，它就不会报错了，因为 <cite>1.</cite> 它会解释成浮点数， <cite>.is_integer()</cite> 就是正常的方法调用了。</p>
<p> 那么在 Python 中整数就没办法直接调用方法了么？</p>
<blockquote>
那倒不是，方法还挺多。</blockquote>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="mi">1</span> <span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c"># 空格可以任意添加多个 </span>
<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="mi">3</span>
</pre></div>
</td></tr></table><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="mi">3</span>
</pre></div>
</td></tr></table><p> 再来个疯狂一点的：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="mi">1</span>       <span class="o">.</span>         <span class="n">__add__</span>       <span class="p">(</span> <span class="mi">2</span>            <span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="mi">3</span>
</pre></div>
</td></tr></table><p>StackOverFlow 上面有一个问题解释得比较详细： <a class="reference external" href="http://stackoverflow.com/questions/12025531/why-does-1-add-2-not-work-out">why-does-1-add-2-not-work-out</a> 。</p>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id14"> 获取当前模块对象 </a></h2>
<p> 获取当前模块的名称很容易。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="n">__name__</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="s">&#39;__main__&#39;</span>
</pre></div>
</td></tr></table><p> 但有时我们需要获取当前的模块对象，并且对它做一些有趣的事。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">59</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">sys</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">60</span><span class="p">]:</span> <span class="n">current_module</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="n">test_var</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">61</span><span class="o">-</span><span class="mi">2538835</span><span class="n">f11fb</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">test_var</span>

<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s">&#39;test_var&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">62</span><span class="p">]:</span> <span class="n">current_module</span><span class="o">.</span><span class="n">test_var</span> <span class="o">=</span> <span class="s">&quot;hack var&quot;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="n">test_var</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="s">&#39;hack var&#39;</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="startswith-endswith">
<h2><a class="toc-backref" href="#id15">startswith&amp;&amp;endswith</a></h2>
<p><cite>startswith</cite> 和 <cite>endswith</cite> 的用法相信大家都知道。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">l</span> <span class="o">=</span> <span class="s">&quot;abcdefg&quot;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="bp">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">l</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&quot;fg&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="bp">True</span>
</pre></div>
</td></tr></table><p> 但是有时候想判断多个 <cite>startswith</cite> 或者  <cite>endswith</cite> ，我们一般会写成：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;bc&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="bp">True</span>
</pre></div>
</td></tr></table><p> 如果是三个或者三个以上的话，就要写个循环或者其相等体来判断。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">any</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&quot;ab&quot;</span><span class="p">,</span> <span class="s">&quot;cd&quot;</span><span class="p">,</span> <span class="s">&quot;ef&quot;</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="bp">True</span>
</pre></div>
</td></tr></table><p> 那，有没有比较方便的判断方法呢？</p>
<p> 咱们看一下 <cite>startswith</cite> 和 <cite>endswith</cite> 的函数说明。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="err">?</span>
<span class="n">Type</span><span class="p">:</span>        <span class="n">builtin_function_or_method</span>
<span class="n">String</span> <span class="n">form</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">method</span> <span class="n">startswith</span> <span class="n">of</span> <span class="nb">str</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x8aec300</span><span class="o">&gt;</span>
<span class="n">Docstring</span><span class="p">:</span>
<span class="n">S</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">[,</span> <span class="n">start</span><span class="p">[,</span> <span class="n">end</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span>

<span class="n">Return</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">S</span> <span class="n">starts</span> <span class="k">with</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">prefix</span><span class="p">,</span> <span class="bp">False</span> <span class="n">otherwise</span><span class="o">.</span>
<span class="n">With</span> <span class="n">optional</span> <span class="n">start</span><span class="p">,</span> <span class="n">test</span> <span class="n">S</span> <span class="n">beginning</span> <span class="n">at</span> <span class="n">that</span> <span class="n">position</span><span class="o">.</span>
<span class="n">With</span> <span class="n">optional</span> <span class="n">end</span><span class="p">,</span> <span class="n">stop</span> <span class="n">comparing</span> <span class="n">S</span> <span class="n">at</span> <span class="n">that</span> <span class="n">position</span><span class="o">.</span>
<span class="n">prefix</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">a</span> <span class="nb">tuple</span> <span class="n">of</span> <span class="n">strings</span> <span class="n">to</span> <span class="k">try</span><span class="o">.</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">l</span><span class="o">.</span><span class="n">endswith</span><span class="err">?</span>
<span class="n">Type</span><span class="p">:</span>        <span class="n">builtin_function_or_method</span>
<span class="n">String</span> <span class="n">form</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">method</span> <span class="n">endswith</span> <span class="n">of</span> <span class="nb">str</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x8aec300</span><span class="o">&gt;</span>
<span class="n">Docstring</span><span class="p">:</span>
<span class="n">S</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">[,</span> <span class="n">start</span><span class="p">[,</span> <span class="n">end</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span>

<span class="n">Return</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">S</span> <span class="n">ends</span> <span class="k">with</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">suffix</span><span class="p">,</span> <span class="bp">False</span> <span class="n">otherwise</span><span class="o">.</span>
<span class="n">With</span> <span class="n">optional</span> <span class="n">start</span><span class="p">,</span> <span class="n">test</span> <span class="n">S</span> <span class="n">beginning</span> <span class="n">at</span> <span class="n">that</span> <span class="n">position</span><span class="o">.</span>
<span class="n">With</span> <span class="n">optional</span> <span class="n">end</span><span class="p">,</span> <span class="n">stop</span> <span class="n">comparing</span> <span class="n">S</span> <span class="n">at</span> <span class="n">that</span> <span class="n">position</span><span class="o">.</span>
<span class="n">suffix</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">a</span> <span class="nb">tuple</span> <span class="n">of</span> <span class="n">strings</span> <span class="n">to</span> <span class="k">try</span><span class="o">.</span>
</pre></div>
</td></tr></table><p> 哈哈，看到最后一行，发现它们的参数还可以是一个元组。</p>
<blockquote>
prefix can also be a tuple of strings to try.</blockquote>
<p> 所以，想判断多个开头或者结尾的话，传入一个元组即可。</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s">&quot;ab&quot;</span><span class="p">,</span> <span class="s">&quot;bc&quot;</span><span class="p">,</span> <span class="s">&quot;cd&quot;</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="bp">True</span>
</pre></div>
</td></tr></table></div>

            
            <section>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="http://chenjiee815.github.io/pythonxiao-tie-shi-chi-xu-geng-xin.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
                    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'chenjiee815blog';
        var disqus_identifier = 'http://chenjiee815.github.io/pythonxiao-tie-shi-chi-xu-geng-xin.html';
    var disqus_url = 'http://chenjiee815.github.io/pythonxiao-tie-shi-chi-xu-geng-xin.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                </div>
            </div>
        </div>
    </div>
</div>
</section>

            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2014-10-03T10:37:41.950917">Oct 3, 2014</time>
            <h4>Category</h4>
            <a class="category-link" href="http://chenjiee815.github.io/categories.html#python-ref">python</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="http://chenjiee815.github.io/tags.html#python-ref">python
                    <span>16</span>
</a></li>
                <li><a href="http://chenjiee815.github.io/tags.html#tip-ref">tip
                    <span>1</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="http://www.htdp.org/" title="My HTDP Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-htdp sidebar-social-links"></i></a>
    <a href="http://mitpress.mit.edu/sicp/" title="My SICP Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-sicp sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>

                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

            <script type="text/javascript">
var disqus_shortname = 'chenjiee815blog';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<script  language="javascript" type="text/javascript">
function uncollapse() {
    if (window.location.hash.match(/^#comment-\d+$/)) {
        $('#disqus_thread').collapse('show');
    }
}
</script>
<script type="text/javascript" language="JavaScript">
uncollapse();
window.onhashchange=function(){
    if (window.location.hash.match(/^#comment-\d+$/))
        window.location.reload(true);
}
</script>
<script>
$('#disqus_thread').on('shown', function () {
    var link = document.getElementsByClassName('accordion-toggle');
    var old_innerHTML = link[0].innerHTML;
    $(link[0]).fadeOut(500, function() {
        $(this).text('Click here to hide comments').fadeIn(500);
    });
    $('#disqus_thread').on('hidden', function () {
        $(link[0]).fadeOut(500, function() {
            $(this).text(old_innerHTML).fadeIn(500);
        });
    })
})
</script>


    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>